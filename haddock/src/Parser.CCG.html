<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS -Wall #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, FlexibleInstances #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">{-|
Module      : Parser.CCG
Copyright   : (c) Daisuke Bekki, 2016
Licence     : All right reserved
Maintainer  : Daisuke Bekki &lt;bekki@is.ocha.ac.jp&gt;
Stability   : beta

Syntactic categories, syntactic features and combinatory rules of Combinatory Categorial Grammar.
-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parser.CCG</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-comment">-- * Types</span><span>
</span><a name="line-15"></a><span>  </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>  </span><a href="Parser.CCG.html#RuleSymbol"><span class="hs-identifier hs-type">RuleSymbol</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>  </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>  </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>  </span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-comment">-- * Text and TeX interface</span><span>
</span><a name="line-21"></a><span>  </span><a href="Parser.CCG.html#showScore"><span class="hs-identifier hs-var">showScore</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-comment">-- * Tests</span><span>
</span><a name="line-23"></a><span>  </span><a href="Parser.CCG.html#isBaseCategory"><span class="hs-identifier hs-var">isBaseCategory</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>  </span><a href="Parser.CCG.html#isBunsetsu"><span class="hs-identifier hs-var">isBunsetsu</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-comment">-- * Combinatory Rules</span><span>
</span><a name="line-26"></a><span>  </span><a href="Parser.CCG.html#unaryRules"><span class="hs-identifier hs-var">unaryRules</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>  </span><a href="Parser.CCG.html#binaryRules"><span class="hs-identifier hs-var">binaryRules</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>  </span><a href="Parser.CCG.html#coordinationRule"><span class="hs-identifier hs-var">coordinationRule</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>  </span><a href="Parser.CCG.html#parenthesisRule"><span class="hs-identifier hs-var">parenthesisRule</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-comment">-- * for debugging</span><span>
</span><a name="line-31"></a><span>  </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-comment">-- * Partial Parsing</span><span>
</span><a name="line-34"></a><span>  </span><a href="Parser.CCG.html#wrapNode"><span class="hs-identifier hs-var">wrapNode</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>  </span><a href="Parser.CCG.html#conjoinNodes"><span class="hs-identifier hs-var">conjoinNodes</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-comment">-- drel,</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span> </span><span class="hs-comment">--text</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>      </span><span class="hs-comment">--base</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-comment">--base</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Fixed</span><span>                    </span><span class="hs-comment">--base</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Ratio</span><span>                    </span><span class="hs-comment">--base</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="DTS.UDTT.html"><span class="hs-identifier">DTS.UDTT</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="Interface.Text.html"><span class="hs-identifier">Interface.Text</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="Interface.TeX.html"><span class="hs-identifier">Interface.TeX</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="Interface.HTML.html"><span class="hs-identifier">Interface.HTML</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | A node in CCG derivation tree.</span><span>
</span><a name="line-51"></a><span class="hs-keyword">data</span><span> </span><a name="Node"><a href="Parser.CCG.html#Node"><span class="hs-identifier">Node</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Node"><a href="Parser.CCG.html#Node"><span class="hs-identifier">Node</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-52"></a><span>  </span><a name="rs"><a href="Parser.CCG.html#rs"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#RuleSymbol"><span class="hs-identifier hs-type">RuleSymbol</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ The name of the rule</span><span>
</span><a name="line-53"></a><span>  </span><a name="pf"><a href="Parser.CCG.html#pf"><span class="hs-identifier">pf</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- ^ The phonetic form</span><span>
</span><a name="line-54"></a><span>  </span><a name="cat"><a href="Parser.CCG.html#cat"><span class="hs-identifier">cat</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- ^ The syntactic category (in CCG)</span><span>
</span><a name="line-55"></a><span>  </span><a name="sem"><a href="Parser.CCG.html#sem"><span class="hs-identifier">sem</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="DTS.UDTT.html#Preterm"><span class="hs-identifier hs-type">Preterm</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- ^ The semantic representation (in DTS)</span><span>
</span><a name="line-56"></a><span>  </span><a name="sig"><a href="Parser.CCG.html#sig"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="DTS.UDTT.html#Signature"><span class="hs-identifier hs-type">Signature</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- ^ Signature</span><span>
</span><a name="line-57"></a><span>  </span><a name="daughters"><a href="Parser.CCG.html#daughters"><span class="hs-identifier">daughters</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The daughter nodes</span><span>
</span><a name="line-58"></a><span>  </span><a name="score"><a href="Parser.CCG.html#score"><span class="hs-identifier">score</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- ^ The score (between 0.00 to 1.00, larger the better)</span><span>
</span><a name="line-59"></a><span>  </span><a name="source"><a href="Parser.CCG.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>    </span><span class="hs-comment">-- ^ The source of the lexical entry</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>  </span><a name="local-8214565720323784874"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">-- | A node with a larger score is less than the one with a smaller score, thus larger comes earlier in [Node]</span><span>
</span><a name="line-66"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">score</span><span class="hs-glyph">=</span><a name="local-6989586621679065537"><a href="#local-6989586621679065537"><span class="hs-identifier">i</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a name="local-8214565720323791196"><span class="hs-identifier">compare</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">score</span><span class="hs-glyph">=</span><a name="local-6989586621679065538"><a href="#local-6989586621679065538"><span class="hs-identifier">j</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679065537"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679065538"><span class="hs-identifier hs-var">j</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679065537"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065538"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679065537"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679065538"><span class="hs-identifier hs-var">j</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">{- Printing Nodes -}</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- | shows the score of the given node</span><span>
</span><a name="line-76"></a><span class="hs-identifier">showScore</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-77"></a><a name="showScore"><a href="Parser.CCG.html#showScore"><span class="hs-identifier">showScore</span></a></a><span> </span><a name="local-6989586621679065542"><a href="#local-6989586621679065542"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromRational</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">score</span><span> </span><a href="#local-6989586621679065542"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Fixed</span><span> </span><span class="hs-identifier hs-type">E2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.Text.html#SimpleText"><span class="hs-identifier hs-type">SimpleText</span></a><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-80"></a><span>  </span><a name="local-8214565720323820400"><a href="Interface.Text.html#toText"><span class="hs-identifier">toText</span></a></a><span> </span><a name="local-6989586621679065531"><a href="#local-6989586621679065531"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-comment">-- @(Node _ _ _ _ sig' _ _ _) </span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065532"><span class="hs-identifier hs-var">toTextLoop</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679065531"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;Sig. &quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sig</span><span> </span><a href="#local-6989586621679065531"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679065532"><a href="#local-6989586621679065532"><span class="hs-identifier">toTextLoop</span></a></a><span> </span><a name="local-6989586621679065533"><a href="#local-6989586621679065533"><span class="hs-identifier">indent</span></a></a><span> </span><a name="local-6989586621679065534"><a href="#local-6989586621679065534"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-83"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">daughters</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-84"></a><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">T.pack</span><span> </span><a href="#local-6989586621679065533"><span class="hs-identifier hs-var">indent</span></a><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rs</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pf</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">source</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; [&quot;</span><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#showScore"><span class="hs-identifier hs-var">showScore</span></a><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]\n&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span>              </span><a name="local-6989586621679065535"><a href="#local-6989586621679065535"><span class="hs-identifier">dtrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">T.pack</span><span> </span><a href="#local-6989586621679065533"><span class="hs-identifier hs-var">indent</span></a><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rs</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; [&quot;</span><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#showScore"><span class="hs-identifier hs-var">showScore</span></a><span> </span><a href="#local-6989586621679065534"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]\n&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679065536"><a href="#local-6989586621679065536"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065532"><span class="hs-identifier hs-var">toTextLoop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065533"><span class="hs-identifier hs-var">indent</span></a><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;  &quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065536"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065535"><span class="hs-identifier hs-var">dtrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.TeX.html#Typeset"><span class="hs-identifier hs-type">Typeset</span></a><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>  </span><a name="local-8214565720323812935"><a href="Interface.TeX.html#toTeX"><span class="hs-identifier">toTeX</span></a></a><span> </span><a name="local-6989586621679065529"><a href="#local-6989586621679065529"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- @(Node _ _ _ _ _ _ _ _) =</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">daughters</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-90"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;\\vvlex[&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">source</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]{&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pf</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}{&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}{&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-comment">--, &quot;\\ensuremath{&quot;, (source node), &quot;}&quot;]</span><span>
</span><a name="line-91"></a><span>      </span><a name="local-6989586621679065530"><a href="#local-6989586621679065530"><span class="hs-identifier">dtrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;\\nd[&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rs</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]{\\vvcat{&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}{&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679065529"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}}{&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.intercalate</span><span> </span><span class="hs-string">&quot;&amp;&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065530"><span class="hs-identifier hs-var">dtrs</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-comment">--, &quot;\\ensuremath{&quot;, (source node), &quot;}&quot;]</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.HTML.html#MathML"><span class="hs-identifier hs-type">MathML</span></a><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>  </span><a name="local-8214565720323810527"><a href="Interface.HTML.html#toMathML"><span class="hs-identifier">toMathML</span></a></a><span> </span><a name="local-6989586621679065527"><a href="#local-6989586621679065527"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- @(Node _ _ _ _ _ _ _ _) =</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">daughters</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-96"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mrow&gt;&lt;mfrac linethickness='2px'&gt;&lt;mtext fontsize='1.0' color='Black'&gt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pf</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&lt;mfrac linethickness='0px'&gt;&lt;mstyle color='Red'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mstyle&gt;&lt;mstyle color='Black'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mstyle&gt;&lt;/mfrac&gt;&lt;/mfrac&gt;&lt;mtext fontsize='0.8' color='Black'&gt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">source</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&lt;/mrow&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-97"></a><span>      </span><a name="local-6989586621679065528"><a href="#local-6989586621679065528"><span class="hs-identifier">dtrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mrow&gt;&lt;mfrac linethickness='2px'&gt;&lt;mrow&gt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065528"><span class="hs-identifier hs-var">dtrs</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mrow&gt;&lt;mfrac linethickness='0px'&gt;&lt;mstyle color='Red'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mstyle&gt;&lt;mstyle color='Black'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mstyle&gt;&lt;/mfrac&gt;&lt;/mfrac&gt;&lt;mtext fontsize='0.8' color='Black'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">rs</span><span> </span><a href="#local-6989586621679065527"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&lt;/mrow&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | Syntactic categories of </span><span>
</span><a name="line-100"></a><span class="hs-keyword">data</span><span> </span><a name="Cat"><a href="Parser.CCG.html#Cat"><span class="hs-identifier">Cat</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-101"></a><span>  </span><a name="S"><a href="Parser.CCG.html#S"><span class="hs-identifier">S</span></a></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ S</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="NP"><a href="Parser.CCG.html#NP"><span class="hs-identifier">NP</span></a></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ NP</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="N"><a href="Parser.CCG.html#N"><span class="hs-identifier">N</span></a></a><span>                </span><span class="hs-comment">-- ^ N</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sbar"><a href="Parser.CCG.html#Sbar"><span class="hs-identifier">Sbar</span></a></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ S bar</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="CONJ"><a href="Parser.CCG.html#CONJ"><span class="hs-identifier">CONJ</span></a></a><span>             </span><span class="hs-comment">-- ^ CON</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LPAREN"><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier">LPAREN</span></a></a><span>           </span><span class="hs-comment">-- ^ A category for left parentheses</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RPAREN"><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier">RPAREN</span></a></a><span>           </span><span class="hs-comment">-- ^ A category for right parentheses</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SL"><a href="Parser.CCG.html#SL"><span class="hs-identifier">SL</span></a></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>       </span><span class="hs-comment">-- ^ X/Y</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BS"><a href="Parser.CCG.html#BS"><span class="hs-identifier">BS</span></a></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>       </span><span class="hs-comment">-- ^ X\\Y</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="T"><a href="Parser.CCG.html#T"><span class="hs-identifier">T</span></a></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>   </span><span class="hs-comment">-- ^ Category variables, where Int is an index, Cat is a restriction for its head. </span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- | checks if given two categories can be coordinated.</span><span>
</span><a name="line-113"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-114"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065509"><a href="#local-6989586621679065509"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679065510"><a href="#local-6989586621679065510"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065511"><a href="#local-6989586621679065511"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679065512"><a href="#local-6989586621679065512"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065509"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065511"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065510"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065512"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065513"><a href="#local-6989586621679065513"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679065514"><a href="#local-6989586621679065514"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065515"><a href="#local-6989586621679065515"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679065516"><a href="#local-6989586621679065516"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065513"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065515"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065514"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065516"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065517"><a href="#local-6989586621679065517"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065518"><a href="#local-6989586621679065518"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065519"><a href="#local-6989586621679065519"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065520"><a href="#local-6989586621679065520"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065517"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065519"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065518"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065520"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065521"><a href="#local-6989586621679065521"><span class="hs-identifier">f1</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065522"><a href="#local-6989586621679065522"><span class="hs-identifier">f2</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyFeature"><span class="hs-identifier hs-var">unifyFeature</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065521"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065522"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-118"></a><span>                                     </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-119"></a><span>                                     </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-120"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065523"><a href="#local-6989586621679065523"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065524"><a href="#local-6989586621679065524"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#unifiable"><span class="hs-identifier hs-var">unifiable</span></a><span> </span><a href="#local-6989586621679065523"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065524"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-121"></a><span>  </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-122"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065525"><a href="#local-6989586621679065525"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065526"><a href="#local-6989586621679065526"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#unifiable"><span class="hs-identifier hs-var">unifiable</span></a><span> </span><a href="#local-6989586621679065525"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065526"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-123"></a><span>  </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-124"></a><span>  </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-125"></a><span>  </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">-- | `toText` method is invoked.</span><span>
</span><a name="line-129"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-130"></a><span>  </span><a name="local-8214565720323784874"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.Text.html#SimpleText"><span class="hs-identifier hs-type">SimpleText</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-133"></a><span>  </span><a name="local-8214565720323820400"><a href="Interface.Text.html#toText"><span class="hs-identifier">toText</span></a></a><span> </span><a name="local-6989586621679065494"><a href="#local-6989586621679065494"><span class="hs-identifier">category</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065494"><span class="hs-identifier hs-var">category</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-134"></a><span>    </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065497"><a href="#local-6989586621679065497"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065498"><a href="#local-6989586621679065498"><span class="hs-identifier">y</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065497"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;/&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065495"><span class="hs-identifier hs-var">toText'</span></a><span> </span><a href="#local-6989586621679065498"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span>    </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065499"><a href="#local-6989586621679065499"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065500"><a href="#local-6989586621679065500"><span class="hs-identifier">y</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065499"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;\\&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065495"><span class="hs-identifier hs-var">toText'</span></a><span> </span><a href="#local-6989586621679065500"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-136"></a><span class="hs-comment">--    T True i c     -&gt; T.concat [&quot;T[&quot;,toText c,&quot;]&lt;&quot;, (T.pack $ show i),&quot;&gt;&quot;]</span><span>
</span><a name="line-137"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a name="local-6989586621679065501"><a href="#local-6989586621679065501"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065501"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-138"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621679065502"><a href="#local-6989586621679065502"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065503"><a href="#local-6989586621679065503"><span class="hs-identifier">c</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065503"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065502"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span>    </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679065504"><a href="#local-6989586621679065504"><span class="hs-identifier">pos</span></a></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065505"><a href="#local-6989586621679065505"><span class="hs-identifier">conj</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065506"><a href="#local-6989586621679065506"><span class="hs-identifier">pmf</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-140"></a><span>              </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-141"></a><span>                       </span><span class="hs-string">&quot;S[&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-142"></a><span>                       </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065504"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">,</span><span class="hs-string">&quot;][&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-143"></a><span>                       </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065505"><span class="hs-identifier hs-var">conj</span></a><span class="hs-special">,</span><span class="hs-string">&quot;][&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-144"></a><span>                       </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065506"><span class="hs-identifier hs-var">pmf</span></a><span class="hs-special">,</span><span>
</span><a name="line-145"></a><span>                       </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-146"></a><span>                       </span><span class="hs-special">]</span><span>
</span><a name="line-147"></a><span>    </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679065507"><a href="#local-6989586621679065507"><span class="hs-identifier">cas</span></a></a><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;NP[&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065507"><span class="hs-identifier hs-var">cas</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-148"></a><span>    </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679065508"><a href="#local-6989586621679065508"><span class="hs-identifier">sf</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Sbar[&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065508"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;]&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span>    </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;N&quot;</span><span>
</span><a name="line-150"></a><span>    </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;CONJ&quot;</span><span>
</span><a name="line-151"></a><span>    </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;LPAREN&quot;</span><span>
</span><a name="line-152"></a><span>    </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;RPAREN&quot;</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;Error in Simpletext Cat&quot;</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- A bracketed version of `toText'` function</span><span>
</span><a name="line-155"></a><span>    </span><a name="local-6989586621679065495"><a href="#local-6989586621679065495"><span class="hs-identifier">toText'</span></a></a><span> </span><a name="local-6989586621679065496"><a href="#local-6989586621679065496"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Parser.CCG.html#isBaseCategory"><span class="hs-identifier hs-var">isBaseCategory</span></a><span> </span><a href="#local-6989586621679065496"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-156"></a><span>                  </span><span class="hs-keyword">then</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065496"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-157"></a><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065496"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.TeX.html#Typeset"><span class="hs-identifier hs-type">Typeset</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-160"></a><span>  </span><a name="local-8214565720323812935"><a href="Interface.TeX.html#toTeX"><span class="hs-identifier">toTeX</span></a></a><span> </span><a name="local-6989586621679065478"><a href="#local-6989586621679065478"><span class="hs-identifier">category</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065478"><span class="hs-identifier hs-var">category</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-161"></a><span>    </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065481"><a href="#local-6989586621679065481"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065482"><a href="#local-6989586621679065482"><span class="hs-identifier">y</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065481"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;/&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065479"><span class="hs-identifier hs-var">toTeX'</span></a><span> </span><a href="#local-6989586621679065482"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-162"></a><span>    </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065483"><a href="#local-6989586621679065483"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065484"><a href="#local-6989586621679065484"><span class="hs-identifier">y</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065483"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;{\\bs}&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065479"><span class="hs-identifier hs-var">toTeX'</span></a><span> </span><a href="#local-6989586621679065484"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a name="local-6989586621679065485"><a href="#local-6989586621679065485"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065486"><a href="#local-6989586621679065486"><span class="hs-identifier">u</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;\\vT^{\\sq{&quot;</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065485"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;}}_{&quot;</span><span class="hs-special">,</span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065486"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621679065487"><a href="#local-6989586621679065487"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065488"><a href="#local-6989586621679065488"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065479"><span class="hs-identifier hs-var">toTeX'</span></a><span> </span><a href="#local-6989586621679065488"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;^{\\sq{&quot;</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065487"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;}}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-165"></a><span>    </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679065489"><a href="#local-6989586621679065489"><span class="hs-identifier">pos</span></a></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065490"><a href="#local-6989586621679065490"><span class="hs-identifier">conj</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065491"><a href="#local-6989586621679065491"><span class="hs-identifier">pm</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-166"></a><span>                   </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-167"></a><span>                     </span><span class="hs-string">&quot;S\\f{&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-168"></a><span>                     </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065489"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">,</span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-169"></a><span>                     </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065490"><span class="hs-identifier hs-var">conj</span></a><span class="hs-special">,</span><span class="hs-string">&quot;,&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-170"></a><span>                     </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065491"><span class="hs-identifier hs-var">pm</span></a><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>                     </span><span class="hs-string">&quot;}&quot;</span><span>
</span><a name="line-172"></a><span>                     </span><span class="hs-special">]</span><span>
</span><a name="line-173"></a><span>    </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679065492"><a href="#local-6989586621679065492"><span class="hs-identifier">cas</span></a></a><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;\\np\\f{&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065492"><span class="hs-identifier hs-var">cas</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-174"></a><span>    </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679065493"><a href="#local-6989586621679065493"><span class="hs-identifier">sf</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;\\bar{S}\\f{&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065493"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-175"></a><span>    </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;N&quot;</span><span>
</span><a name="line-176"></a><span>    </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;\\conj&quot;</span><span>
</span><a name="line-177"></a><span>    </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;LPAREN&quot;</span><span>
</span><a name="line-178"></a><span>    </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;RPAREN&quot;</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;Error: toTeX Cat&quot;</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679065479"><a href="#local-6989586621679065479"><span class="hs-identifier">toTeX'</span></a></a><span> </span><a name="local-6989586621679065480"><a href="#local-6989586621679065480"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Parser.CCG.html#isBaseCategory"><span class="hs-identifier hs-var">isBaseCategory</span></a><span> </span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-181"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-182"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;(&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.HTML.html#MathML"><span class="hs-identifier hs-type">MathML</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>  </span><a name="local-8214565720323810527"><a href="Interface.HTML.html#toMathML"><span class="hs-identifier">toMathML</span></a></a><span> </span><a name="local-6989586621679065462"><a href="#local-6989586621679065462"><span class="hs-identifier">category</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065462"><span class="hs-identifier hs-var">category</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-186"></a><span>    </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065465"><a href="#local-6989586621679065465"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065466"><a href="#local-6989586621679065466"><span class="hs-identifier">y</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mrow&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065465"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;mo&gt;/&lt;/mo&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065463"><span class="hs-identifier hs-var">toMathML'</span></a><span> </span><a href="#local-6989586621679065466"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mrow&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-187"></a><span>    </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065467"><a href="#local-6989586621679065467"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065468"><a href="#local-6989586621679065468"><span class="hs-identifier">y</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mrow&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065467"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;mo&gt;\\&lt;/mo&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065463"><span class="hs-identifier hs-var">toMathML'</span></a><span> </span><a href="#local-6989586621679065468"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mrow&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-188"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a name="local-6989586621679065469"><a href="#local-6989586621679065469"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;&quot;</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065469"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;&lt;/mn&gt;&lt;/msub&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-189"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621679065470"><a href="#local-6989586621679065470"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065471"><a href="#local-6989586621679065471"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;msub&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065463"><span class="hs-identifier hs-var">toMathML'</span></a><span> </span><a href="#local-6989586621679065471"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;mn&gt;&quot;</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065470"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;&lt;/mn&gt;&lt;/msub&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-190"></a><span>    </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679065472"><a href="#local-6989586621679065472"><span class="hs-identifier">pos</span></a></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065473"><a href="#local-6989586621679065473"><span class="hs-identifier">conj</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065474"><a href="#local-6989586621679065474"><span class="hs-identifier">pm</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-191"></a><span>                   </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-192"></a><span>                     </span><span class="hs-string">&quot;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mstyle color='Purple'&gt;&lt;mtable columnalign='left'&gt;&lt;mtr&gt;&lt;mtd&gt;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-193"></a><span>                     </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065472"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">,</span><span class="hs-string">&quot;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mpadded height='-0.5em'&gt;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-194"></a><span>                     </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065473"><span class="hs-identifier hs-var">conj</span></a><span class="hs-special">,</span><span>
</span><a name="line-195"></a><span>                     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065475"><a href="#local-6989586621679065475"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065474"><span class="hs-identifier hs-var">pm</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-196"></a><span>                       </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">T.null</span><span> </span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-197"></a><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">T.empty</span><span>
</span><a name="line-198"></a><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">T.append</span><span> </span><span class="hs-string">&quot;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mpadded height='-0.5em'&gt;&quot;</span><span> </span><a href="#local-6989586621679065475"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span>
</span><a name="line-199"></a><span>                     </span><span class="hs-string">&quot;&lt;/mpadded&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mstyle&gt;&lt;/msub&gt;&quot;</span><span>
</span><a name="line-200"></a><span>                     </span><span class="hs-special">]</span><span>
</span><a name="line-201"></a><span>    </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679065476"><a href="#local-6989586621679065476"><span class="hs-identifier">cas</span></a></a><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;msub&gt;&lt;mi&gt;NP&lt;/mi&gt;&lt;mtext color='Purple'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065476"><span class="hs-identifier hs-var">cas</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&lt;/msub&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-202"></a><span>    </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679065477"><a href="#local-6989586621679065477"><span class="hs-identifier">sf</span></a></a><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;msub&gt;&lt;menclose notation='top'&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/menclose&gt;&lt;mtext color='Purple'&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065477"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&lt;/msub&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-203"></a><span>    </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;mi&gt;N&lt;/mi&gt;&quot;</span><span>
</span><a name="line-204"></a><span>    </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;mi&gt;CONJ&lt;/mi&gt;&quot;</span><span>
</span><a name="line-205"></a><span>    </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;mi&gt;LPAREN&lt;/mi&gt;&quot;</span><span>
</span><a name="line-206"></a><span>    </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;mi&gt;RPAREN&lt;/mi&gt;&quot;</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;mtext&gt;Error: toMathML Cat&lt;/mtext&gt;&quot;</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-comment">-- newcat = T.replace &quot;&gt;&quot; &quot;&amp;gt;&quot; $ T.replace &quot;&lt;&quot; &quot;&amp;lt;&quot; $ toText (cat node);</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679065463"><a href="#local-6989586621679065463"><span class="hs-identifier">toMathML'</span></a></a><span> </span><a name="local-6989586621679065464"><a href="#local-6989586621679065464"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Parser.CCG.html#isBaseCategory"><span class="hs-identifier hs-var">isBaseCategory</span></a><span> </span><a href="#local-6989586621679065464"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-210"></a><span>                        </span><span class="hs-keyword">then</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065464"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-211"></a><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.HTML.html#toMathML"><span class="hs-identifier hs-var">toMathML</span></a><span> </span><a href="#local-6989586621679065464"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- | Syntactic features of </span><span>
</span><a name="line-214"></a><span class="hs-keyword">data</span><span> </span><a name="Feature"><a href="Parser.CCG.html#Feature"><span class="hs-identifier">Feature</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-215"></a><span>  </span><a name="F"><a href="Parser.CCG.html#F"><span class="hs-identifier">F</span></a></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ Syntactic feature</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SF"><a href="Parser.CCG.html#SF"><span class="hs-identifier">SF</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Shared syntactic feature (with an index)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | Values of syntactic features of Japanese </span><span>
</span><a name="line-220"></a><span class="hs-keyword">data</span><span> </span><a name="FeatureValue"><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier">FeatureValue</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-221"></a><span>  </span><a name="V5k"><a href="Parser.CCG.html#V5k"><span class="hs-identifier">V5k</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5s"><a href="Parser.CCG.html#V5s"><span class="hs-identifier">V5s</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5t"><a href="Parser.CCG.html#V5t"><span class="hs-identifier">V5t</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5n"><a href="Parser.CCG.html#V5n"><span class="hs-identifier">V5n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5m"><a href="Parser.CCG.html#V5m"><span class="hs-identifier">V5m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5r"><a href="Parser.CCG.html#V5r"><span class="hs-identifier">V5r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5w"><a href="Parser.CCG.html#V5w"><span class="hs-identifier">V5w</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5g"><a href="Parser.CCG.html#V5g"><span class="hs-identifier">V5g</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5z"><a href="Parser.CCG.html#V5z"><span class="hs-identifier">V5z</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5b"><a href="Parser.CCG.html#V5b"><span class="hs-identifier">V5b</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-222"></a><span>  </span><a name="V5IKU"><a href="Parser.CCG.html#V5IKU"><span class="hs-identifier">V5IKU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5YUK"><a href="Parser.CCG.html#V5YUK"><span class="hs-identifier">V5YUK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5ARU"><a href="Parser.CCG.html#V5ARU"><span class="hs-identifier">V5ARU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5NAS"><a href="Parser.CCG.html#V5NAS"><span class="hs-identifier">V5NAS</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="V5TOW"><a href="Parser.CCG.html#V5TOW"><span class="hs-identifier">V5TOW</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-223"></a><span>  </span><a name="V1"><a href="Parser.CCG.html#V1"><span class="hs-identifier">V1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VK"><a href="Parser.CCG.html#VK"><span class="hs-identifier">VK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VS"><a href="Parser.CCG.html#VS"><span class="hs-identifier">VS</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VSN"><a href="Parser.CCG.html#VSN"><span class="hs-identifier">VSN</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VZ"><a href="Parser.CCG.html#VZ"><span class="hs-identifier">VZ</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VURU"><a href="Parser.CCG.html#VURU"><span class="hs-identifier">VURU</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-224"></a><span>  </span><a name="Aauo"><a href="Parser.CCG.html#Aauo"><span class="hs-identifier">Aauo</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ai"><a href="Parser.CCG.html#Ai"><span class="hs-identifier">Ai</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ANAS"><a href="Parser.CCG.html#ANAS"><span class="hs-identifier">ANAS</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ATII"><a href="Parser.CCG.html#ATII"><span class="hs-identifier">ATII</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ABES"><a href="Parser.CCG.html#ABES"><span class="hs-identifier">ABES</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-225"></a><span>  </span><a name="Nda"><a href="Parser.CCG.html#Nda"><span class="hs-identifier">Nda</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Nna"><a href="Parser.CCG.html#Nna"><span class="hs-identifier">Nna</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Nno"><a href="Parser.CCG.html#Nno"><span class="hs-identifier">Nno</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ntar"><a href="Parser.CCG.html#Ntar"><span class="hs-identifier">Ntar</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Nni"><a href="Parser.CCG.html#Nni"><span class="hs-identifier">Nni</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Nemp"><a href="Parser.CCG.html#Nemp"><span class="hs-identifier">Nemp</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Nto"><a href="Parser.CCG.html#Nto"><span class="hs-identifier">Nto</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-226"></a><span>  </span><a name="Exp"><a href="Parser.CCG.html#Exp"><span class="hs-identifier">Exp</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- Error |</span><span>
</span><a name="line-227"></a><span>  </span><a name="Stem"><a href="Parser.CCG.html#Stem"><span class="hs-identifier">Stem</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="UStem"><a href="Parser.CCG.html#UStem"><span class="hs-identifier">UStem</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NStem"><a href="Parser.CCG.html#NStem"><span class="hs-identifier">NStem</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-228"></a><span>  </span><a name="Neg"><a href="Parser.CCG.html#Neg"><span class="hs-identifier">Neg</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Cont"><a href="Parser.CCG.html#Cont"><span class="hs-identifier">Cont</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Term"><a href="Parser.CCG.html#Term"><span class="hs-identifier">Term</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Attr"><a href="Parser.CCG.html#Attr"><span class="hs-identifier">Attr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Hyp"><a href="Parser.CCG.html#Hyp"><span class="hs-identifier">Hyp</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Imper"><a href="Parser.CCG.html#Imper"><span class="hs-identifier">Imper</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Pre"><a href="Parser.CCG.html#Pre"><span class="hs-identifier">Pre</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NTerm"><a href="Parser.CCG.html#NTerm"><span class="hs-identifier">NTerm</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-229"></a><span>  </span><a name="NegL"><a href="Parser.CCG.html#NegL"><span class="hs-identifier">NegL</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TeForm"><a href="Parser.CCG.html#TeForm"><span class="hs-identifier">TeForm</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NiForm"><a href="Parser.CCG.html#NiForm"><span class="hs-identifier">NiForm</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-230"></a><span>  </span><a name="EuphT"><a href="Parser.CCG.html#EuphT"><span class="hs-identifier">EuphT</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="EuphD"><a href="Parser.CCG.html#EuphD"><span class="hs-identifier">EuphD</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-231"></a><span>  </span><a name="ModU"><a href="Parser.CCG.html#ModU"><span class="hs-identifier">ModU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ModD"><a href="Parser.CCG.html#ModD"><span class="hs-identifier">ModD</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ModS"><a href="Parser.CCG.html#ModS"><span class="hs-identifier">ModS</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ModM"><a href="Parser.CCG.html#ModM"><span class="hs-identifier">ModM</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-232"></a><span>  </span><a name="VoR"><a href="Parser.CCG.html#VoR"><span class="hs-identifier">VoR</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VoS"><a href="Parser.CCG.html#VoS"><span class="hs-identifier">VoS</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VoE"><a href="Parser.CCG.html#VoE"><span class="hs-identifier">VoE</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-233"></a><span>  </span><a name="P"><a href="Parser.CCG.html#P"><span class="hs-identifier">P</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="M"><a href="Parser.CCG.html#M"><span class="hs-identifier">M</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-234"></a><span>  </span><a name="Nc"><a href="Parser.CCG.html#Nc"><span class="hs-identifier">Nc</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ga"><a href="Parser.CCG.html#Ga"><span class="hs-identifier">Ga</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="O"><a href="Parser.CCG.html#O"><span class="hs-identifier">O</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ni"><a href="Parser.CCG.html#Ni"><span class="hs-identifier">Ni</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="To"><a href="Parser.CCG.html#To"><span class="hs-identifier">To</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Niyotte"><a href="Parser.CCG.html#Niyotte"><span class="hs-identifier">Niyotte</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="No"><a href="Parser.CCG.html#No"><span class="hs-identifier">No</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-235"></a><span>  </span><a name="ToCL"><a href="Parser.CCG.html#ToCL"><span class="hs-identifier">ToCL</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="YooniCL"><a href="Parser.CCG.html#YooniCL"><span class="hs-identifier">YooniCL</span></a></a><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-236"></a><span>  </span><a name="Decl"><a href="Parser.CCG.html#Decl"><span class="hs-identifier">Decl</span></a></a><span>
</span><a name="line-237"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-240"></a><span>  </span><a name="local-8214565720323784874"><span class="hs-identifier">show</span></a><span> </span><a href="Parser.CCG.html#V5k"><span class="hs-identifier hs-var">V5k</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:k&quot;</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5s"><span class="hs-identifier hs-var">V5s</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:s&quot;</span><span>
</span><a name="line-242"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5t"><span class="hs-identifier hs-var">V5t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:t&quot;</span><span>
</span><a name="line-243"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5n"><span class="hs-identifier hs-var">V5n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:n&quot;</span><span>
</span><a name="line-244"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5m"><span class="hs-identifier hs-var">V5m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:m&quot;</span><span>
</span><a name="line-245"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5r"><span class="hs-identifier hs-var">V5r</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:r&quot;</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5w"><span class="hs-identifier hs-var">V5w</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:w&quot;</span><span>
</span><a name="line-247"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5g"><span class="hs-identifier hs-var">V5g</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:g&quot;</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5z"><span class="hs-identifier hs-var">V5z</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:z&quot;</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5b"><span class="hs-identifier hs-var">V5b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:b&quot;</span><span>
</span><a name="line-250"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5IKU"><span class="hs-identifier hs-var">V5IKU</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:IKU&quot;</span><span>
</span><a name="line-251"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5YUK"><span class="hs-identifier hs-var">V5YUK</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:YUK&quot;</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5ARU"><span class="hs-identifier hs-var">V5ARU</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:ARU&quot;</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5NAS"><span class="hs-identifier hs-var">V5NAS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:NAS&quot;</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V5TOW"><span class="hs-identifier hs-var">V5TOW</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:5:TOW&quot;</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#V1"><span class="hs-identifier hs-var">V1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:1&quot;</span><span>
</span><a name="line-256"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VK"><span class="hs-identifier hs-var">VK</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:K&quot;</span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VS"><span class="hs-identifier hs-var">VS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:S&quot;</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VSN"><span class="hs-identifier hs-var">VSN</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:SN&quot;</span><span>
</span><a name="line-259"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VZ"><span class="hs-identifier hs-var">VZ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:Z&quot;</span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VURU"><span class="hs-identifier hs-var">VURU</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;v:URU&quot;</span><span>
</span><a name="line-261"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Aauo"><span class="hs-identifier hs-var">Aauo</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;a:i:auo&quot;</span><span>
</span><a name="line-262"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Ai"><span class="hs-identifier hs-var">Ai</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;a:i:i&quot;</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ANAS"><span class="hs-identifier hs-var">ANAS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;a:i:NAS&quot;</span><span>
</span><a name="line-264"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ATII"><span class="hs-identifier hs-var">ATII</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;a:i:TII&quot;</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ABES"><span class="hs-identifier hs-var">ABES</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;a:BES&quot;</span><span>
</span><a name="line-266"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nda"><span class="hs-identifier hs-var">Nda</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:da&quot;</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nna"><span class="hs-identifier hs-var">Nna</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:na&quot;</span><span>
</span><a name="line-268"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nno"><span class="hs-identifier hs-var">Nno</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:no&quot;</span><span>
</span><a name="line-269"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nni"><span class="hs-identifier hs-var">Nni</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:ni&quot;</span><span>
</span><a name="line-270"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nemp"><span class="hs-identifier hs-var">Nemp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:\\emp&quot;</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Ntar"><span class="hs-identifier hs-var">Ntar</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:tar&quot;</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nto"><span class="hs-identifier hs-var">Nto</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;n:to&quot;</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;exp&quot;</span><span>
</span><a name="line-274"></a><span>  </span><span class="hs-comment">-- show Error = &quot;error&quot;</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Stem"><span class="hs-identifier hs-var">Stem</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;stem&quot;</span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#UStem"><span class="hs-identifier hs-var">UStem</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;ustem&quot;</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#NStem"><span class="hs-identifier hs-var">NStem</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;nstem&quot;</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Neg"><span class="hs-identifier hs-var">Neg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;neg&quot;</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Cont"><span class="hs-identifier hs-var">Cont</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;cont&quot;</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Term"><span class="hs-identifier hs-var">Term</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;term&quot;</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;attr&quot;</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Hyp"><span class="hs-identifier hs-var">Hyp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;hyp&quot;</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Imper"><span class="hs-identifier hs-var">Imper</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;imp&quot;</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Pre"><span class="hs-identifier hs-var">Pre</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;pre&quot;</span><span>
</span><a name="line-286"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#NTerm"><span class="hs-identifier hs-var">NTerm</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;nterm&quot;</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#NegL"><span class="hs-identifier hs-var">NegL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;neg+l&quot;</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#TeForm"><span class="hs-identifier hs-var">TeForm</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;te&quot;</span><span>
</span><a name="line-289"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#NiForm"><span class="hs-identifier hs-var">NiForm</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;ni&quot;</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#EuphT"><span class="hs-identifier hs-var">EuphT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;euph:t&quot;</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#EuphD"><span class="hs-identifier hs-var">EuphD</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;euph:d&quot;</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ModU"><span class="hs-identifier hs-var">ModU</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;mod:u&quot;</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ModD"><span class="hs-identifier hs-var">ModD</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;mod:d&quot;</span><span>
</span><a name="line-294"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ModS"><span class="hs-identifier hs-var">ModS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;mod:s&quot;</span><span>
</span><a name="line-295"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ModM"><span class="hs-identifier hs-var">ModM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;mod:m&quot;</span><span>
</span><a name="line-296"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VoR"><span class="hs-identifier hs-var">VoR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;vo:r&quot;</span><span>
</span><a name="line-297"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VoS"><span class="hs-identifier hs-var">VoS</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;vo:s&quot;</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#VoE"><span class="hs-identifier hs-var">VoE</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;vo:e&quot;</span><span>
</span><a name="line-299"></a><span>  </span><span class="hs-comment">-- </span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#ToCL"><span class="hs-identifier hs-var">ToCL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;to&quot;</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#YooniCL"><span class="hs-identifier hs-var">YooniCL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;yooni&quot;</span><span>
</span><a name="line-302"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;decl&quot;</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-304"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;+&quot;</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-&quot;</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Nc"><span class="hs-identifier hs-var">Nc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;nc&quot;</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Ga"><span class="hs-identifier hs-var">Ga</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;ga&quot;</span><span>
</span><a name="line-309"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;o&quot;</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Ni"><span class="hs-identifier hs-var">Ni</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;ni&quot;</span><span>
</span><a name="line-311"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#To"><span class="hs-identifier hs-var">To</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;to&quot;</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#Niyotte"><span class="hs-identifier hs-var">Niyotte</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;niyotte&quot;</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Parser.CCG.html#No"><span class="hs-identifier hs-var">No</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;no&quot;</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-comment">-- | checks if two lists of features are unifiable.</span><span>
</span><a name="line-316"></a><span class="hs-identifier">unifiable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-317"></a><a name="unifiable"><a href="Parser.CCG.html#unifiable"><span class="hs-identifier">unifiable</span></a></a><span> </span><a name="local-6989586621679065543"><a href="#local-6989586621679065543"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679065544"><a href="#local-6989586621679065544"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyFeatures"><span class="hs-identifier hs-var">unifyFeatures</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065543"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065544"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-318"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-319"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">{- Text interface -}</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.Text.html#SimpleText"><span class="hs-identifier hs-type">SimpleText</span></a><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-324"></a><span>  </span><a name="local-8214565720323820400"><a href="Interface.Text.html#toText"><span class="hs-identifier">toText</span></a></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065459"><a href="#local-6989586621679065459"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065460"><a href="#local-6989586621679065460"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065460"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065459"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-325"></a><span>  </span><span class="hs-identifier">toText</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065461"><a href="#local-6989586621679065461"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065461"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-comment">-- | prints a value of a syntactic feature.</span><span>
</span><a name="line-328"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.Text.html#SimpleText"><span class="hs-identifier hs-type">SimpleText</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-329"></a><span>  </span><a name="local-8214565720323820400"><a href="Interface.Text.html#toText"><span class="hs-identifier">toText</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.empty</span><span>
</span><a name="line-330"></a><span>  </span><span class="hs-identifier">toText</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679065453"><a href="#local-6989586621679065453"><span class="hs-identifier">pos</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065453"><span class="hs-identifier hs-var">pos</span></a><span>
</span><a name="line-331"></a><span>  </span><span class="hs-identifier">toText</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679065454"><a href="#local-6989586621679065454"><span class="hs-identifier">pos1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065455"><a href="#local-6989586621679065455"><span class="hs-identifier">pos2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065454"><span class="hs-identifier hs-var">pos1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065455"><span class="hs-identifier hs-var">pos2</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>  </span><span class="hs-comment">--toText (pos1:(pos2:_)) = T.pack $ (show pos1) ++ &quot;|&quot; ++ (show pos2) ++ &quot;|+&quot;</span><span>
</span><a name="line-333"></a><span>  </span><span class="hs-identifier">toText</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065456"><a href="#local-6989586621679065456"><span class="hs-identifier">pos1</span></a></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065457"><a href="#local-6989586621679065457"><span class="hs-identifier">pos2</span></a></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065458"><a href="#local-6989586621679065458"><span class="hs-identifier">pos3</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065456"><span class="hs-identifier hs-var">pos1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065457"><span class="hs-identifier hs-var">pos2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065458"><span class="hs-identifier hs-var">pos3</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|+&quot;</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | prints a list of syntactic features each of which ranges over {P,M,PM}.</span><span>
</span><a name="line-336"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.Text.html#SimpleText"><span class="hs-identifier hs-type">SimpleText</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-337"></a><span>  </span><a name="local-8214565720323820400"><a href="Interface.Text.html#toText"><span class="hs-identifier">toText</span></a></a><span> </span><a name="local-6989586621679065452"><a href="#local-6989586621679065452"><span class="hs-identifier">pmfs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.intercalate</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Maybe.catMaybes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#printPMFsLoop"><span class="hs-identifier hs-var">printPMFsLoop</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;t&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;p&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;n&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;N&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065452"><span class="hs-identifier hs-var">pmfs</span></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-identifier">printPMFsLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">]</span><span>
</span><a name="line-340"></a><a name="printPMFsLoop"><a href="Parser.CCG.html#printPMFsLoop"><span class="hs-identifier">printPMFsLoop</span></a></a><span> </span><a name="local-6989586621679065545"><a href="#local-6989586621679065545"><span class="hs-identifier">labels</span></a></a><span> </span><a name="local-6989586621679065546"><a href="#local-6989586621679065546"><span class="hs-identifier">pmfs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065545"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">,</span><a href="#local-6989586621679065546"><span class="hs-identifier hs-var">pmfs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-341"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-342"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679065547"><a href="#local-6989586621679065547"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065548"><a href="#local-6989586621679065548"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a name="local-6989586621679065549"><a href="#local-6989586621679065549"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065550"><a href="#local-6989586621679065550"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#printPMF"><span class="hs-identifier hs-var">printPMF</span></a><span> </span><a href="#local-6989586621679065547"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679065549"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.CCG.html#printPMFsLoop"><span class="hs-identifier hs-var">printPMFsLoop</span></a><span> </span><a href="#local-6989586621679065548"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679065550"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Error: mismatch in &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065545"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; and &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065546"><span class="hs-identifier hs-var">pmfs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- | prints a syntactic feature that ranges over {P,M,PM}.</span><span>
</span><a name="line-346"></a><span class="hs-identifier">printPMF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-347"></a><a name="printPMF"><a href="Parser.CCG.html#printPMF"><span class="hs-identifier">printPMF</span></a></a><span> </span><span class="hs-keyword">label</span><span> </span><a name="local-6989586621679065552"><a href="#local-6989586621679065552"><span class="hs-identifier">pmf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">label</span><span class="hs-special">,</span><a href="#local-6989586621679065552"><span class="hs-identifier hs-var">pmf</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-348"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065553"><a href="#local-6989586621679065553"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065553"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-349"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-comment">-- if shared then Just $ T.concat [&quot;-&quot;, l] else Nothing</span><span>
</span><a name="line-350"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065554"><a href="#local-6989586621679065554"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&#177;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065554"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-351"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065555"><a href="#local-6989586621679065555"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&#177;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065555"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-352"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065556"><a href="#local-6989586621679065556"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065557"><a href="#local-6989586621679065557"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065558"><a href="#local-6989586621679065558"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-353"></a><span>                   </span><a name="local-6989586621679065559"><a href="#local-6989586621679065559"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#printPMF"><span class="hs-identifier hs-var">printPMF</span></a><span> </span><a href="#local-6989586621679065556"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a href="#local-6989586621679065558"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>                   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065559"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-string">&quot;&lt;&quot;</span><span class="hs-special">,</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065557"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-355"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Error: printPMF&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065552"><span class="hs-identifier hs-var">pmf</span></a><span class="hs-special">]</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">{- TeX Interface -}</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.TeX.html#Typeset"><span class="hs-identifier hs-type">Typeset</span></a><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-360"></a><span>  </span><a name="local-8214565720323812935"><a href="Interface.TeX.html#toTeX"><span class="hs-identifier">toTeX</span></a></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065449"><a href="#local-6989586621679065449"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065450"><a href="#local-6989586621679065450"><span class="hs-identifier">ft</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065450"><span class="hs-identifier hs-var">ft</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;:\\sq{&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065449"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-361"></a><span>  </span><span class="hs-identifier">toTeX</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065451"><a href="#local-6989586621679065451"><span class="hs-identifier">ft</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065451"><span class="hs-identifier hs-var">ft</span></a><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.TeX.html#Typeset"><span class="hs-identifier hs-type">Typeset</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-364"></a><span>  </span><a name="local-8214565720323812935"><a href="Interface.TeX.html#toTeX"><span class="hs-identifier">toTeX</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.empty</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-identifier">toTeX</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679065444"><a href="#local-6989586621679065444"><span class="hs-identifier">pos</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065444"><span class="hs-identifier hs-var">pos</span></a><span>
</span><a name="line-366"></a><span>  </span><span class="hs-identifier">toTeX</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679065445"><a href="#local-6989586621679065445"><span class="hs-identifier">pos1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065446"><a href="#local-6989586621679065446"><span class="hs-identifier">pos2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065445"><span class="hs-identifier hs-var">pos1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065446"><span class="hs-identifier hs-var">pos2</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>  </span><span class="hs-identifier">toTeX</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065447"><a href="#local-6989586621679065447"><span class="hs-identifier">pos1</span></a></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065448"><a href="#local-6989586621679065448"><span class="hs-identifier">pos2</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065447"><span class="hs-identifier hs-var">pos1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">pos2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;|+&quot;</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span class="hs-identifier">pmf2TeX</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-370"></a><a name="pmf2TeX"><a href="Parser.CCG.html#pmf2TeX"><span class="hs-identifier">pmf2TeX</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-keyword">label</span><span> </span><a name="local-6989586621679065561"><a href="#local-6989586621679065561"><span class="hs-identifier">pmf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">label</span><span class="hs-special">,</span><a href="#local-6989586621679065561"><span class="hs-identifier hs-var">pmf</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-371"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065562"><a href="#local-6989586621679065562"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;{+}&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065562"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-372"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-comment">-- if shared then Just $ T.concat [&quot;{-}&quot;, l] else Nothing</span><span>
</span><a name="line-373"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065563"><a href="#local-6989586621679065563"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;{\\pm}&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065563"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-374"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065564"><a href="#local-6989586621679065564"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;{\\pm}&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065564"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-375"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679065565"><a href="#local-6989586621679065565"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065566"><a href="#local-6989586621679065566"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065567"><a href="#local-6989586621679065567"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-376"></a><span>                 </span><a name="local-6989586621679065568"><a href="#local-6989586621679065568"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#pmf2TeX"><span class="hs-identifier hs-var">pmf2TeX</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621679065565"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a href="#local-6989586621679065567"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065568"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-string">&quot;:\\sq{&quot;</span><span class="hs-special">,</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065566"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-string">&quot;}&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-378"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;Error: pmf2TeX&quot;</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.TeX.html#Typeset"><span class="hs-identifier hs-type">Typeset</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-381"></a><span>  </span><a name="local-8214565720323812935"><a href="Interface.TeX.html#toTeX"><span class="hs-identifier">toTeX</span></a></a><span> </span><a name="local-6989586621679065443"><a href="#local-6989586621679065443"><span class="hs-identifier">pmfs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.intercalate</span><span> </span><span class="hs-string">&quot;{,}&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Maybe.catMaybes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#pmfs2TeXLoop"><span class="hs-identifier hs-var">pmfs2TeXLoop</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;t&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;p&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;n&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;N&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065443"><span class="hs-identifier hs-var">pmfs</span></a><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-identifier">pmfs2TeXLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">]</span><span>
</span><a name="line-384"></a><a name="pmfs2TeXLoop"><a href="Parser.CCG.html#pmfs2TeXLoop"><span class="hs-identifier">pmfs2TeXLoop</span></a></a><span> </span><a name="local-6989586621679065569"><a href="#local-6989586621679065569"><span class="hs-identifier">labels</span></a></a><span> </span><a name="local-6989586621679065570"><a href="#local-6989586621679065570"><span class="hs-identifier">pmfs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065569"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">,</span><a href="#local-6989586621679065570"><span class="hs-identifier hs-var">pmfs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-385"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-386"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679065571"><a href="#local-6989586621679065571"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065572"><a href="#local-6989586621679065572"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a name="local-6989586621679065573"><a href="#local-6989586621679065573"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065574"><a href="#local-6989586621679065574"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#pmf2TeX"><span class="hs-identifier hs-var">pmf2TeX</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679065571"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679065573"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.CCG.html#pmfs2TeXLoop"><span class="hs-identifier hs-var">pmfs2TeXLoop</span></a><span> </span><a href="#local-6989586621679065572"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679065574"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Error: mismatch in &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065569"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; and &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065570"><span class="hs-identifier hs-var">pmfs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-comment">{- MathML Interface -}</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.HTML.html#MathML"><span class="hs-identifier hs-type">MathML</span></a><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-392"></a><span>  </span><a name="local-8214565720323810527"><a href="Interface.HTML.html#toMathML"><span class="hs-identifier">toMathML</span></a></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065440"><a href="#local-6989586621679065440"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065441"><a href="#local-6989586621679065441"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mtext&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065441"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;menclose notation='box'&gt;&lt;mn&gt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065440"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mn&gt;&lt;/menclose&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-393"></a><span>  </span><span class="hs-identifier">toMathML</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065442"><a href="#local-6989586621679065442"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&lt;mtext&gt;&quot;</span><span class="hs-special">,</span><span> </span><a href="Interface.TeX.html#toTeX"><span class="hs-identifier hs-var">toTeX</span></a><span> </span><a href="#local-6989586621679065442"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mtext&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-identifier">pmf2MathML</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-396"></a><a name="pmf2MathML"><a href="Parser.CCG.html#pmf2MathML"><span class="hs-identifier">pmf2MathML</span></a></a><span> </span><span class="hs-keyword">label</span><span> </span><a name="local-6989586621679065576"><a href="#local-6989586621679065576"><span class="hs-identifier">pmf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">label</span><span class="hs-special">,</span><a href="#local-6989586621679065576"><span class="hs-identifier hs-var">pmf</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-397"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679065577"><a href="#local-6989586621679065577"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;+&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065577"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-398"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-comment">-- if shared then Just $ T.concat [&quot;{-}&quot;, l] else Nothing</span><span>
</span><a name="line-399"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679065578"><a href="#local-6989586621679065578"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&amp;plusmn;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065578"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-400"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679065579"><a href="#local-6989586621679065579"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#M"><span class="hs-identifier hs-var">M</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#P"><span class="hs-identifier hs-var">P</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;&amp;plusmn;&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065579"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-401"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679065580"><a href="#local-6989586621679065580"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065581"><a href="#local-6989586621679065581"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065582"><a href="#local-6989586621679065582"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-402"></a><span>                 </span><a name="local-6989586621679065583"><a href="#local-6989586621679065583"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#pmf2MathML"><span class="hs-identifier hs-var">pmf2MathML</span></a><span> </span><a href="#local-6989586621679065580"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a href="#local-6989586621679065582"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065583"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;:&lt;menclose notation='box'&gt;&lt;mn&gt;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065581"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&lt;/mn&gt;&lt;/menclose&gt;&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-404"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;Error: pmf2MathML&quot;</span><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.HTML.html#MathML"><span class="hs-identifier hs-type">MathML</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-407"></a><span>  </span><a name="local-8214565720323810527"><a href="Interface.HTML.html#toMathML"><span class="hs-identifier">toMathML</span></a></a><span> </span><a name="local-6989586621679065439"><a href="#local-6989586621679065439"><span class="hs-identifier">pmfs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.intercalate</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Maybe.catMaybes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#pmfs2MathMLLoop"><span class="hs-identifier hs-var">pmfs2MathMLLoop</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;t&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;p&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;n&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;N&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;T&quot;</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065439"><span class="hs-identifier hs-var">pmfs</span></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-identifier">pmfs2MathMLLoop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span class="hs-special">]</span><span>
</span><a name="line-410"></a><a name="pmfs2MathMLLoop"><a href="Parser.CCG.html#pmfs2MathMLLoop"><span class="hs-identifier">pmfs2MathMLLoop</span></a></a><span> </span><a name="local-6989586621679065584"><a href="#local-6989586621679065584"><span class="hs-identifier">labels</span></a></a><span> </span><a name="local-6989586621679065585"><a href="#local-6989586621679065585"><span class="hs-identifier">pmfs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065584"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">,</span><a href="#local-6989586621679065585"><span class="hs-identifier hs-var">pmfs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-411"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-412"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679065586"><a href="#local-6989586621679065586"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065587"><a href="#local-6989586621679065587"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a name="local-6989586621679065588"><a href="#local-6989586621679065588"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065589"><a href="#local-6989586621679065589"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#pmf2MathML"><span class="hs-identifier hs-var">pmf2MathML</span></a><span> </span><a href="#local-6989586621679065586"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679065588"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.CCG.html#pmfs2MathMLLoop"><span class="hs-identifier hs-var">pmfs2MathMLLoop</span></a><span> </span><a href="#local-6989586621679065587"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679065589"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Error: mismatch in &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065584"><span class="hs-identifier hs-var">labels</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; and &quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679065585"><span class="hs-identifier hs-var">pmfs</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-comment">{- Tests for syntactic categories -}</span><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-comment">-- | A test to check if a given category is a base category (i.e. not a functional category nor a category variable).</span><span>
</span><a name="line-418"></a><span class="hs-identifier">isBaseCategory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-419"></a><a name="isBaseCategory"><a href="Parser.CCG.html#isBaseCategory"><span class="hs-identifier">isBaseCategory</span></a></a><span> </span><a name="local-6989586621679065590"><a href="#local-6989586621679065590"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065590"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-420"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-421"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-422"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065591"><a href="#local-6989586621679065591"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#isBaseCategory"><span class="hs-identifier hs-var">isBaseCategory</span></a><span> </span><a href="#local-6989586621679065591"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-423"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-424"></a><span>  </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-425"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-426"></a><span>  </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-427"></a><span>  </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-428"></a><span>  </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-429"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-identifier">isArgumentCategory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-432"></a><a name="isArgumentCategory"><a href="Parser.CCG.html#isArgumentCategory"><span class="hs-identifier">isArgumentCategory</span></a></a><span> </span><a name="local-6989586621679065592"><a href="#local-6989586621679065592"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065592"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-433"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Parser.CCG.html#isNoncaseNP"><span class="hs-identifier hs-var">isNoncaseNP</span></a><span> </span><a href="#local-6989586621679065592"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-434"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-435"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-436"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-comment">-- | A test to check if a given category is T\NPnc.</span><span>
</span><a name="line-439"></a><span class="hs-identifier">isTNoncaseNP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-440"></a><a name="isTNoncaseNP"><a href="Parser.CCG.html#isTNoncaseNP"><span class="hs-identifier">isTNoncaseNP</span></a></a><span> </span><a name="local-6989586621679065593"><a href="#local-6989586621679065593"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065593"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-441"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065594"><a href="#local-6989586621679065594"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#isNoncaseNP"><span class="hs-identifier hs-var">isNoncaseNP</span></a><span> </span><a href="#local-6989586621679065594"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-442"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span class="hs-identifier">isNoncaseNP</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-445"></a><a name="isNoncaseNP"><a href="Parser.CCG.html#isNoncaseNP"><span class="hs-identifier">isNoncaseNP</span></a></a><span> </span><a name="local-6989586621679065595"><a href="#local-6989586621679065595"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065595"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-446"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065596"><a href="#local-6989586621679065596"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Nc"><span class="hs-identifier hs-var">Nc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065596"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-447"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065597"><a href="#local-6989586621679065597"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Nc"><span class="hs-identifier hs-var">Nc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065597"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-448"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-comment">-- | A test to check if a given category is the one that can appear on the left adjacent of a punctuation.</span><span>
</span><a name="line-451"></a><span class="hs-identifier">isBunsetsu</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-452"></a><a name="isBunsetsu"><a href="Parser.CCG.html#isBunsetsu"><span class="hs-identifier">isBunsetsu</span></a></a><span> </span><a name="local-6989586621679065598"><a href="#local-6989586621679065598"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065598"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-453"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065599"><a href="#local-6989586621679065599"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#isBunsetsu"><span class="hs-identifier hs-var">isBunsetsu</span></a><span> </span><a href="#local-6989586621679065599"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-454"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065600"><a href="#local-6989586621679065600"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#isBunsetsu"><span class="hs-identifier hs-var">isBunsetsu</span></a><span> </span><a href="#local-6989586621679065600"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-455"></a><span>  </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-456"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065601"><a href="#local-6989586621679065601"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065602"><a href="#local-6989586621679065602"><span class="hs-identifier">katsuyo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065601"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-457"></a><span>                                 </span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065603"><a href="#local-6989586621679065603"><span class="hs-identifier">feat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065603"><span class="hs-identifier hs-var">feat</span></a><span>
</span><a name="line-458"></a><span>                                 </span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065604"><a href="#local-6989586621679065604"><span class="hs-identifier">feat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065604"><span class="hs-identifier hs-var">feat</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-459"></a><span>                 </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L.intersect</span><span> </span><a href="#local-6989586621679065602"><span class="hs-identifier hs-var">katsuyo</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Cont"><span class="hs-identifier hs-var">Cont</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#Term"><span class="hs-identifier hs-var">Term</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#Attr"><span class="hs-identifier hs-var">Attr</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#Hyp"><span class="hs-identifier hs-var">Hyp</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#Imper"><span class="hs-identifier hs-var">Imper</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#Pre"><span class="hs-identifier hs-var">Pre</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#NTerm"><span class="hs-identifier hs-var">NTerm</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#NStem"><span class="hs-identifier hs-var">NStem</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#TeForm"><span class="hs-identifier hs-var">TeForm</span></a><span class="hs-special">,</span><a href="Parser.CCG.html#NiForm"><span class="hs-identifier hs-var">NiForm</span></a><span class="hs-special">]</span><span>
</span><a name="line-460"></a><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-461"></a><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-462"></a><span>  </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-463"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span class="hs-identifier">endsWithT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-466"></a><a name="endsWithT"><a href="Parser.CCG.html#endsWithT"><span class="hs-identifier">endsWithT</span></a></a><span> </span><a name="local-6989586621679065605"><a href="#local-6989586621679065605"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065605"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-467"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065606"><a href="#local-6989586621679065606"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#endsWithT"><span class="hs-identifier hs-var">endsWithT</span></a><span> </span><a href="#local-6989586621679065606"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-468"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-469"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span class="hs-identifier">isNStem</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-472"></a><a name="isNStem"><a href="Parser.CCG.html#isNStem"><span class="hs-identifier">isNStem</span></a></a><span> </span><a name="local-6989586621679065607"><a href="#local-6989586621679065607"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065607"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-473"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065608"><a href="#local-6989586621679065608"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#isNStem"><span class="hs-identifier hs-var">isNStem</span></a><span> </span><a href="#local-6989586621679065608"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-474"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679065609"><a href="#local-6989586621679065609"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyFeature"><span class="hs-identifier hs-var">unifyFeature</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065609"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">[</span><a href="Parser.CCG.html#NStem"><span class="hs-identifier hs-var">NStem</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-475"></a><span>                   </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-476"></a><span>                   </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-477"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-comment">-- | The name of the CCG rule to derive the node.</span><span>
</span><a name="line-480"></a><span class="hs-keyword">data</span><span> </span><a name="RuleSymbol"><a href="Parser.CCG.html#RuleSymbol"><span class="hs-identifier">RuleSymbol</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-481"></a><span>  </span><a name="LEX"><a href="Parser.CCG.html#LEX"><span class="hs-identifier">LEX</span></a></a><span>    </span><span class="hs-comment">-- ^ A lexical item</span><span>
</span><a name="line-482"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="EC"><a href="Parser.CCG.html#EC"><span class="hs-identifier">EC</span></a></a><span>   </span><span class="hs-comment">-- ^ An empty category</span><span>
</span><a name="line-483"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFA"><a href="Parser.CCG.html#FFA"><span class="hs-identifier">FFA</span></a></a><span>  </span><span class="hs-comment">-- ^ Forward function application rule.</span><span>
</span><a name="line-484"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BFA"><a href="Parser.CCG.html#BFA"><span class="hs-identifier">BFA</span></a></a><span>  </span><span class="hs-comment">-- ^ Backward function application rule</span><span>
</span><a name="line-485"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFC1"><a href="Parser.CCG.html#FFC1"><span class="hs-identifier">FFC1</span></a></a><span> </span><span class="hs-comment">-- ^ Forward function composition rule 1</span><span>
</span><a name="line-486"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BFC1"><a href="Parser.CCG.html#BFC1"><span class="hs-identifier">BFC1</span></a></a><span> </span><span class="hs-comment">-- ^ Backward function composition rule 1</span><span>
</span><a name="line-487"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFC2"><a href="Parser.CCG.html#FFC2"><span class="hs-identifier">FFC2</span></a></a><span> </span><span class="hs-comment">-- ^ Forward function composition rule 2</span><span>
</span><a name="line-488"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BFC2"><a href="Parser.CCG.html#BFC2"><span class="hs-identifier">BFC2</span></a></a><span> </span><span class="hs-comment">-- ^ Backward function composition rule 2</span><span>
</span><a name="line-489"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFC3"><a href="Parser.CCG.html#FFC3"><span class="hs-identifier">FFC3</span></a></a><span> </span><span class="hs-comment">-- ^ Forward function composition rule 3</span><span>
</span><a name="line-490"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="BFC3"><a href="Parser.CCG.html#BFC3"><span class="hs-identifier">BFC3</span></a></a><span> </span><span class="hs-comment">-- ^ Backward function composition rule 3</span><span>
</span><a name="line-491"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFCx1"><a href="Parser.CCG.html#FFCx1"><span class="hs-identifier">FFCx1</span></a></a><span> </span><span class="hs-comment">-- ^ Forward function crossed composition rule 1</span><span>
</span><a name="line-492"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFCx2"><a href="Parser.CCG.html#FFCx2"><span class="hs-identifier">FFCx2</span></a></a><span> </span><span class="hs-comment">-- ^ Forward function crossed composition rule 2</span><span>
</span><a name="line-493"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FFSx"><a href="Parser.CCG.html#FFSx"><span class="hs-identifier">FFSx</span></a></a><span>  </span><span class="hs-comment">-- ^ Forward function crossed substitution rule</span><span>
</span><a name="line-494"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="COORD"><a href="Parser.CCG.html#COORD"><span class="hs-identifier">COORD</span></a></a><span> </span><span class="hs-comment">-- ^ Coordination rule</span><span>
</span><a name="line-495"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PAREN"><a href="Parser.CCG.html#PAREN"><span class="hs-identifier">PAREN</span></a></a><span> </span><span class="hs-comment">-- ^ Parenthesis rule</span><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WRAP"><a href="Parser.CCG.html#WRAP"><span class="hs-identifier">WRAP</span></a></a><span>  </span><span class="hs-comment">-- ^ Wrap rule</span><span>
</span><a name="line-497"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DC"><a href="Parser.CCG.html#DC"><span class="hs-identifier">DC</span></a></a><span>    </span><span class="hs-comment">-- ^ Dynamic conjunction rule</span><span>
</span><a name="line-498"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DREL"><a href="Parser.CCG.html#DREL"><span class="hs-identifier">DREL</span></a></a><span>  </span><span class="hs-comment">-- ^ Discourse Relation rule</span><span>
</span><a name="line-499"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-comment">-- | The simple-text representation of the rule symbols.</span><span>
</span><a name="line-502"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.Text.html#SimpleText"><span class="hs-identifier hs-type">SimpleText</span></a><span> </span><a href="Parser.CCG.html#RuleSymbol"><span class="hs-identifier hs-type">RuleSymbol</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-503"></a><span>  </span><a name="local-8214565720323820400"><a href="Interface.Text.html#toText"><span class="hs-identifier">toText</span></a></a><span> </span><a name="local-6989586621679065438"><a href="#local-6989586621679065438"><span class="hs-identifier">rulesymbol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065438"><span class="hs-identifier hs-var">rulesymbol</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-504"></a><span>    </span><a href="Parser.CCG.html#LEX"><span class="hs-identifier hs-var">LEX</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;LEX&quot;</span><span>
</span><a name="line-505"></a><span>    </span><a href="Parser.CCG.html#EC"><span class="hs-identifier hs-var">EC</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;EC&quot;</span><span>
</span><a name="line-506"></a><span>    </span><a href="Parser.CCG.html#FFA"><span class="hs-identifier hs-var">FFA</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span>
</span><a name="line-507"></a><span>    </span><a href="Parser.CCG.html#BFA"><span class="hs-identifier hs-var">BFA</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span>
</span><a name="line-508"></a><span>    </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B&quot;</span><span>
</span><a name="line-509"></a><span>    </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;B&quot;</span><span>
</span><a name="line-510"></a><span>    </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B2&quot;</span><span>
</span><a name="line-511"></a><span>    </span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;B2&quot;</span><span>
</span><a name="line-512"></a><span>    </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B3&quot;</span><span>
</span><a name="line-513"></a><span>    </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;B3&quot;</span><span>
</span><a name="line-514"></a><span>    </span><a href="Parser.CCG.html#FFCx1"><span class="hs-identifier hs-var">FFCx1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;Bx&quot;</span><span>
</span><a name="line-515"></a><span>    </span><a href="Parser.CCG.html#FFCx2"><span class="hs-identifier hs-var">FFCx2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;Bx2&quot;</span><span>
</span><a name="line-516"></a><span>    </span><a href="Parser.CCG.html#FFSx"><span class="hs-identifier hs-var">FFSx</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;Sx&quot;</span><span>
</span><a name="line-517"></a><span>    </span><a href="Parser.CCG.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;&#934;&gt;&quot;</span><span>
</span><a name="line-518"></a><span>    </span><a href="Parser.CCG.html#PAREN"><span class="hs-identifier hs-var">PAREN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;PAREN&quot;</span><span>
</span><a name="line-519"></a><span>    </span><a href="Parser.CCG.html#WRAP"><span class="hs-identifier hs-var">WRAP</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;WRAP&quot;</span><span>
</span><a name="line-520"></a><span>    </span><a href="Parser.CCG.html#DC"><span class="hs-identifier hs-var">DC</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;DC&quot;</span><span>
</span><a name="line-521"></a><span>    </span><a href="Parser.CCG.html#DREL"><span class="hs-identifier hs-var">DREL</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;DREL&quot;</span><span>
</span><a name="line-522"></a><span>    </span><span class="hs-comment">-- CNP -&gt; &quot;CNP&quot;</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.TeX.html#Typeset"><span class="hs-identifier hs-type">Typeset</span></a><span> </span><a href="Parser.CCG.html#RuleSymbol"><span class="hs-identifier hs-type">RuleSymbol</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-525"></a><span>  </span><a name="local-8214565720323812935"><a href="Interface.TeX.html#toTeX"><span class="hs-identifier">toTeX</span></a></a><span> </span><a name="local-6989586621679065437"><a href="#local-6989586621679065437"><span class="hs-identifier">rulesymbol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065437"><span class="hs-identifier hs-var">rulesymbol</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-526"></a><span>    </span><a href="Parser.CCG.html#LEX"><span class="hs-identifier hs-var">LEX</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;lex&quot;</span><span>
</span><a name="line-527"></a><span>    </span><a href="Parser.CCG.html#EC"><span class="hs-identifier hs-var">EC</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;ec&quot;</span><span>
</span><a name="line-528"></a><span>    </span><a href="Parser.CCG.html#FFA"><span class="hs-identifier hs-var">FFA</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span>
</span><a name="line-529"></a><span>    </span><a href="Parser.CCG.html#BFA"><span class="hs-identifier hs-var">BFA</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span>
</span><a name="line-530"></a><span>    </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B&quot;</span><span>
</span><a name="line-531"></a><span>    </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;B&quot;</span><span>
</span><a name="line-532"></a><span>    </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B^2&quot;</span><span>
</span><a name="line-533"></a><span>    </span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;B^2&quot;</span><span>
</span><a name="line-534"></a><span>    </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B^3&quot;</span><span>
</span><a name="line-535"></a><span>    </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&lt;B^3&quot;</span><span>
</span><a name="line-536"></a><span>    </span><a href="Parser.CCG.html#FFCx1"><span class="hs-identifier hs-var">FFCx1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B_{\\times}&quot;</span><span>
</span><a name="line-537"></a><span>    </span><a href="Parser.CCG.html#FFCx2"><span class="hs-identifier hs-var">FFCx2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;B_{\\times}^2&quot;</span><span>
</span><a name="line-538"></a><span>    </span><a href="Parser.CCG.html#FFSx"><span class="hs-identifier hs-var">FFSx</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&gt;S_{\\times}&quot;</span><span>
</span><a name="line-539"></a><span>    </span><a href="Parser.CCG.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;\\langle\\Phi\\rangle&quot;</span><span>
</span><a name="line-540"></a><span>    </span><a href="Parser.CCG.html#PAREN"><span class="hs-identifier hs-var">PAREN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;PAREN&quot;</span><span>
</span><a name="line-541"></a><span>    </span><a href="Parser.CCG.html#WRAP"><span class="hs-identifier hs-var">WRAP</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;WRAP&quot;</span><span>
</span><a name="line-542"></a><span>    </span><a href="Parser.CCG.html#DC"><span class="hs-identifier hs-var">DC</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;DC&quot;</span><span>
</span><a name="line-543"></a><span>    </span><a href="Parser.CCG.html#DREL"><span class="hs-identifier hs-var">DREL</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;DREL&quot;</span><span>
</span><a name="line-544"></a><span>    </span><span class="hs-comment">-- CNP -&gt; &quot;CNP&quot;</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span class="hs-keyword">instance</span><span> </span><a href="Interface.HTML.html#MathML"><span class="hs-identifier hs-type">MathML</span></a><span> </span><a href="Parser.CCG.html#RuleSymbol"><span class="hs-identifier hs-type">RuleSymbol</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-547"></a><span>  </span><a name="local-8214565720323810527"><a href="Interface.HTML.html#toMathML"><span class="hs-identifier">toMathML</span></a></a><span> </span><a name="local-6989586621679065436"><a href="#local-6989586621679065436"><span class="hs-identifier">rulesymbol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.replace</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span> </span><span class="hs-string">&quot;&amp;gt;&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.replace</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span> </span><span class="hs-string">&quot;&amp;lt;&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Interface.Text.html#toText"><span class="hs-identifier hs-var">toText</span></a><span> </span><a href="#local-6989586621679065436"><span class="hs-identifier hs-var">rulesymbol</span></a><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-comment">{- Classes of Combinatory Rules -}</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-comment">-- | The function to apply all the unaryRules to a CCG node.</span><span>
</span><a name="line-552"></a><span class="hs-identifier">unaryRules</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-553"></a><a name="unaryRules"><a href="Parser.CCG.html#unaryRules"><span class="hs-identifier">unaryRules</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065610"><a href="#local-6989586621679065610"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065610"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span class="hs-comment">-- | The function to apply all the binary rules to a given pair of CCG nodes.</span><span>
</span><a name="line-556"></a><span class="hs-identifier">binaryRules</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-557"></a><a name="binaryRules"><a href="Parser.CCG.html#binaryRules"><span class="hs-identifier">binaryRules</span></a></a><span> </span><a name="local-6989586621679065611"><a href="#local-6989586621679065611"><span class="hs-identifier">lnode</span></a></a><span> </span><a name="local-6989586621679065612"><a href="#local-6989586621679065612"><span class="hs-identifier">rnode</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-558"></a><span>  </span><a href="Parser.CCG.html#forwardFunctionCrossedSubstitutionRule"><span class="hs-identifier hs-var">forwardFunctionCrossedSubstitutionRule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-559"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#forwardFunctionCrossedComposition2Rule"><span class="hs-identifier hs-var">forwardFunctionCrossedComposition2Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-560"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#forwardFunctionCrossedComposition1Rule"><span class="hs-identifier hs-var">forwardFunctionCrossedComposition1Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-561"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#backwardFunctionComposition3Rule"><span class="hs-identifier hs-var">backwardFunctionComposition3Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-562"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#backwardFunctionComposition2Rule"><span class="hs-identifier hs-var">backwardFunctionComposition2Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-563"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#forwardFunctionComposition2Rule"><span class="hs-identifier hs-var">forwardFunctionComposition2Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-564"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#backwardFunctionComposition1Rule"><span class="hs-identifier hs-var">backwardFunctionComposition1Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-565"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#forwardFunctionComposition1Rule"><span class="hs-identifier hs-var">forwardFunctionComposition1Rule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-566"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#backwardFunctionApplicationRule"><span class="hs-identifier hs-var">backwardFunctionApplicationRule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-567"></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Parser.CCG.html#forwardFunctionApplicationRule"><span class="hs-identifier hs-var">forwardFunctionApplicationRule</span></a><span> </span><a href="#local-6989586621679065611"><span class="hs-identifier hs-var">lnode</span></a><span> </span><a href="#local-6989586621679065612"><span class="hs-identifier hs-var">rnode</span></a><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-comment">{- Test -}</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-comment">--plus :: [FeatureValue]</span><span>
</span><a name="line-572"></a><span class="hs-comment">--plus = [P]</span><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-comment">{-
minus :: [FeatureValue]
minus = [M]

pm :: [FeatureValue]
pm = [P,M]

verb :: [FeatureValue]
verb = [V5k, V5s, V5t, V5n, V5m, V5r, V5w, V5g, V5z, V5b, V5IKU, V5YUK, V5ARU, V5NAS, V5TOW, V1, VK, VS, VSN, VZ, VURU]

adjective :: [FeatureValue]
adjective = [Aauo, Ai, ANAS, ATII, ABES]

nomPred :: [FeatureValue]
nomPred = [Nda, Nna, Nno, Nni, Nemp, Ntar]

anyPos :: [FeatureValue]
anyPos = verb ++ adjective ++ nomPred ++ [Exp]

nonStem :: [FeatureValue]
nonStem = [Neg, Cont, Term, Attr, Hyp, Imper, Pre, ModU, ModS, VoR, VoS, VoE, NegL, TeForm]

anySExStem :: Cat
anySExStem = S [F anyPos, F nonStem, SF 1 pm, SF 2 pm, SF 3 pm, F minus, F minus]

test :: IO()
test = do
  let x = T True 1 anySExStem ;
      y1 = T True 1 anySExStem `BS` NP [F [Nc]];
      y2 = (T True 1 (S [F anyPos, F nonStem, SF 1 [P,M], SF 2 [P,M], SF 3 [P,M], F[M], F[M]]) `BS` T True 1 (S [F anyPos, F nonStem, SF 1 [P,M], SF 2 [P,M], SF 3 [P,M], F[M], F[M]])) `BS` NP [F [Nc]]
  T.putStrLn &quot;Functional application: x/y1 y2&quot;
  T.putStr &quot;x: &quot;    
  T.putStrLn $ toText x
  T.putStr &quot;y1: &quot;
  T.putStrLn $ toText y1
  T.putStr &quot;y2: &quot;
  T.putStrLn $ toText y2
  let inc = maximumIndexC y2
  T.putStr &quot;maximumIndexC y2: &quot;
  print $ maximumIndexC y2
  T.putStr &quot;increment y1 by inc: &quot;    
  print (incrementIndexC y1 inc)
  let Just uc@(_,csub,fsub) = unifyCategory [] [] y2 (incrementIndexC y1 inc)
  T.putStr &quot;unifyCategory y2 (incr. y1 inc): &quot;
  print uc
  T.putStr &quot;csub: &quot;
  print csub
  T.putStr &quot;fsub: &quot;
  print fsub
  let newcat = simulSubstituteCV csub fsub (incrementIndexC x inc)
  T.putStr &quot;newcat: &quot;
  T.putStrLn $ toText newcat
-}</span><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span class="hs-comment">-- | Forward function application rule.</span><span>
</span><a name="line-629"></a><span class="hs-identifier">forwardFunctionApplicationRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-630"></a><a name="forwardFunctionApplicationRule"><a href="Parser.CCG.html#forwardFunctionApplicationRule"><span class="hs-identifier">forwardFunctionApplicationRule</span></a></a><span> </span><a name="local-6989586621679065613"><a href="#local-6989586621679065613"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065614"><a href="#local-6989586621679065614"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065615"><a href="#local-6989586621679065615"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065616"><a href="#local-6989586621679065616"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065617"><a href="#local-6989586621679065617"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065618"><a href="#local-6989586621679065618"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a name="local-6989586621679065619"><a href="#local-6989586621679065619"><span class="hs-identifier">y2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065620"><a href="#local-6989586621679065620"><span class="hs-identifier">a</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065621"><a href="#local-6989586621679065621"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-631"></a><span>  </span><span class="hs-comment">-- [&gt;] x/y1  y2  ==&gt;  x</span><span>
</span><a name="line-632"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065614"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065614"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065614"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-comment">-- Non-normal forms</span><span>
</span><a name="line-633"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065621"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-634"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-635"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065616"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-636"></a><span>      </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065621"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Ad-hoc rule</span><span>
</span><a name="line-637"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065622"><a href="#local-6989586621679065622"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065619"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-638"></a><span>           </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065619"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065616"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679065622"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-639"></a><span>             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065621"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-640"></a><span>             </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065623"><a href="#local-6989586621679065623"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065624"><a href="#local-6989586621679065624"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-641"></a><span>               </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065625"><a href="#local-6989586621679065625"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065623"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065624"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065615"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065622"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-642"></a><span>                 </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-643"></a><span>                   </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#FFA"><span class="hs-identifier hs-var">FFA</span></a><span class="hs-special">,</span><span>
</span><a name="line-644"></a><span>                   </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065613"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065618"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-645"></a><span>                   </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065625"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-646"></a><span>                   </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065625"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065617"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065620"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span>
</span><a name="line-647"></a><span>                   </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065613"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065618"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-648"></a><span>                   </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065613"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065618"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-649"></a><span>                   </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-comment">--T.concat $ map (\(i,c)-&gt; T.concat [T.pack (show i),&quot; \\mapsto &quot;,toTeX c,&quot;, &quot;]) sub</span><span>
</span><a name="line-650"></a><span>                   </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065613"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065618"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-651"></a><span>                   </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065621"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-652"></a><span class="hs-identifier">forwardFunctionApplicationRule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065626"><a href="#local-6989586621679065626"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065626"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span class="hs-comment">-- | Backward function application rule.</span><span>
</span><a name="line-655"></a><span class="hs-identifier">backwardFunctionApplicationRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-656"></a><a name="backwardFunctionApplicationRule"><a href="Parser.CCG.html#backwardFunctionApplicationRule"><span class="hs-identifier">backwardFunctionApplicationRule</span></a></a><span> </span><a name="local-6989586621679065627"><a href="#local-6989586621679065627"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a name="local-6989586621679065628"><a href="#local-6989586621679065628"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065629"><a href="#local-6989586621679065629"><span class="hs-identifier">a</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065630"><a href="#local-6989586621679065630"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065631"><a href="#local-6989586621679065631"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065632"><a href="#local-6989586621679065632"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065633"><a href="#local-6989586621679065633"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065634"><a href="#local-6989586621679065634"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065635"><a href="#local-6989586621679065635"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-657"></a><span>  </span><span class="hs-comment">-- [&lt;] y1  x\y2  ==&gt; x</span><span>
</span><a name="line-658"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065631"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065631"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065631"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span> </span><span class="hs-comment">-- Non-normal forms</span><span>
</span><a name="line-659"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065635"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-660"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-661"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065636"><a href="#local-6989586621679065636"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065628"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-662"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065628"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065633"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679065636"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-663"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065635"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-664"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065637"><a href="#local-6989586621679065637"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065638"><a href="#local-6989586621679065638"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065639"><a href="#local-6989586621679065639"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065637"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065638"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065632"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065636"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-665"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-666"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#BFA"><span class="hs-identifier hs-var">BFA</span></a><span class="hs-special">,</span><span>
</span><a name="line-667"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065627"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-668"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065639"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-669"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065639"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065634"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065629"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span>
</span><a name="line-670"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065627"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-671"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065627"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-672"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- pf(lnode) `T.append` pf(rnode)</span><span>
</span><a name="line-673"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065627"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065630"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065635"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-675"></a><span class="hs-identifier">backwardFunctionApplicationRule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065640"><a href="#local-6989586621679065640"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065640"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span class="hs-comment">-- | Forward function composition rule.</span><span>
</span><a name="line-678"></a><span class="hs-identifier">forwardFunctionComposition1Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-679"></a><a name="forwardFunctionComposition1Rule"><a href="Parser.CCG.html#forwardFunctionComposition1Rule"><span class="hs-identifier">forwardFunctionComposition1Rule</span></a></a><span> </span><a name="local-6989586621679065641"><a href="#local-6989586621679065641"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065642"><a href="#local-6989586621679065642"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065643"><a href="#local-6989586621679065643"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065644"><a href="#local-6989586621679065644"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065645"><a href="#local-6989586621679065645"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065646"><a href="#local-6989586621679065646"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065647"><a href="#local-6989586621679065647"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679065648"><a href="#local-6989586621679065648"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065649"><a href="#local-6989586621679065649"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065650"><a href="#local-6989586621679065650"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-680"></a><span>  </span><span class="hs-comment">-- [&gt;B] x/y1  y2/z  ==&gt; x/z</span><span>
</span><a name="line-681"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065642"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065642"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065642"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isTNoncaseNP"><span class="hs-identifier hs-var">isTNoncaseNP</span></a><span> </span><a href="#local-6989586621679065644"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Non-normal forms (+ Ad-hoc rule 1)</span><span>
</span><a name="line-682"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065650"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-683"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-684"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065651"><a href="#local-6989586621679065651"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065646"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-685"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065647"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065644"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679065651"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-686"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065650"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-687"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065652"><a href="#local-6989586621679065652"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065653"><a href="#local-6989586621679065653"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-688"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065654"><a href="#local-6989586621679065654"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065652"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065653"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065648"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-689"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Parser.CCG.html#numberOfArguments"><span class="hs-identifier hs-var">numberOfArguments</span></a><span> </span><a href="#local-6989586621679065654"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">3</span><span>  </span><span class="hs-comment">-- Ad-hoc rule 2</span><span>
</span><a name="line-690"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065650"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-691"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065655"><a href="#local-6989586621679065655"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065652"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065653"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065643"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065651"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065654"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-692"></a><span>             </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-693"></a><span>               </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span class="hs-special">,</span><span>
</span><a name="line-694"></a><span>               </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065641"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065646"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-695"></a><span>               </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065655"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-696"></a><span>               </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065655"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065645"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065649"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-697"></a><span>               </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065641"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065646"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-698"></a><span>               </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065641"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065646"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-699"></a><span>               </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-700"></a><span>               </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065641"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065646"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>               </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065650"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-702"></a><span class="hs-identifier">forwardFunctionComposition1Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065656"><a href="#local-6989586621679065656"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065656"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span class="hs-comment">-- | Backward function composition rule.</span><span>
</span><a name="line-705"></a><span class="hs-identifier">backwardFunctionComposition1Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-706"></a><a name="backwardFunctionComposition1Rule"><a href="Parser.CCG.html#backwardFunctionComposition1Rule"><span class="hs-identifier">backwardFunctionComposition1Rule</span></a></a><span> </span><a name="local-6989586621679065657"><a href="#local-6989586621679065657"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065658"><a href="#local-6989586621679065658"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679065659"><a href="#local-6989586621679065659"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065660"><a href="#local-6989586621679065660"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065661"><a href="#local-6989586621679065661"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065662"><a href="#local-6989586621679065662"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065663"><a href="#local-6989586621679065663"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065664"><a href="#local-6989586621679065664"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065665"><a href="#local-6989586621679065665"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065666"><a href="#local-6989586621679065666"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-707"></a><span>  </span><span class="hs-comment">-- [&lt;B] y1\z:g  x\y2:f  ==&gt; x\z</span><span>
</span><a name="line-708"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065662"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065662"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065662"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span> </span><span class="hs-comment">-- Non-normal forms</span><span>
</span><a name="line-709"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065666"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-710"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-711"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065667"><a href="#local-6989586621679065667"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065657"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-712"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065658"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065664"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679065667"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-713"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065666"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-714"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065668"><a href="#local-6989586621679065668"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065669"><a href="#local-6989586621679065669"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065670"><a href="#local-6989586621679065670"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065668"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065669"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065663"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065667"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065659"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-715"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-716"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span class="hs-special">,</span><span>
</span><a name="line-717"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065657"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065661"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-718"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065670"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-719"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065670"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065665"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065660"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-720"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065657"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065661"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-721"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065657"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065661"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-722"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-723"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065657"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065661"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-724"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065666"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-725"></a><span class="hs-identifier">backwardFunctionComposition1Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065671"><a href="#local-6989586621679065671"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065671"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-comment">-- | Forward function composition rule 2.</span><span>
</span><a name="line-728"></a><span class="hs-identifier">forwardFunctionComposition2Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-729"></a><a name="forwardFunctionComposition2Rule"><a href="Parser.CCG.html#forwardFunctionComposition2Rule"><span class="hs-identifier">forwardFunctionComposition2Rule</span></a></a><span> </span><a name="local-6989586621679065672"><a href="#local-6989586621679065672"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065673"><a href="#local-6989586621679065673"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065674"><a href="#local-6989586621679065674"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065675"><a href="#local-6989586621679065675"><span class="hs-identifier">y1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065676"><a href="#local-6989586621679065676"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065677"><a href="#local-6989586621679065677"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065678"><a href="#local-6989586621679065678"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065679"><a href="#local-6989586621679065679"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065680"><a href="#local-6989586621679065680"><span class="hs-identifier">z2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065681"><a href="#local-6989586621679065681"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065682"><a href="#local-6989586621679065682"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-730"></a><span>  </span><span class="hs-comment">-- [&gt;B2] x/y1:f  y2/z1/z2:g  ==&gt; x/z1/z2</span><span>
</span><a name="line-731"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065673"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065673"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065673"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isTNoncaseNP"><span class="hs-identifier hs-var">isTNoncaseNP</span></a><span> </span><a href="#local-6989586621679065675"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Non-normal forms</span><span>
</span><a name="line-732"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065682"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-733"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-734"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065683"><a href="#local-6989586621679065683"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065677"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-735"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065675"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679065683"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065678"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-736"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065682"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-737"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065684"><a href="#local-6989586621679065684"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065685"><a href="#local-6989586621679065685"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-738"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065686"><a href="#local-6989586621679065686"><span class="hs-identifier">z1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065684"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065685"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065679"><span class="hs-identifier hs-var">z1</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-739"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Parser.CCG.html#numberOfArguments"><span class="hs-identifier hs-var">numberOfArguments</span></a><span> </span><a href="#local-6989586621679065686"><span class="hs-identifier hs-var">z1'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">2</span><span>  </span><span class="hs-comment">-- Ad-hoc rule 2</span><span>
</span><a name="line-740"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065682"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-741"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065687"><a href="#local-6989586621679065687"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065684"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065685"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065674"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065683"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065686"><span class="hs-identifier hs-var">z1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065680"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-742"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-743"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span class="hs-special">,</span><span>
</span><a name="line-744"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065672"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065677"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-745"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065687"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-746"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065687"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065676"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065681"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-747"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065672"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065677"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-748"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065672"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065677"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-749"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-750"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065672"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065677"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065682"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-752"></a><span class="hs-identifier">forwardFunctionComposition2Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065688"><a href="#local-6989586621679065688"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065688"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span class="hs-comment">-- | Backward function composition rule 2.</span><span>
</span><a name="line-755"></a><span class="hs-identifier">backwardFunctionComposition2Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-756"></a><a name="backwardFunctionComposition2Rule"><a href="Parser.CCG.html#backwardFunctionComposition2Rule"><span class="hs-identifier">backwardFunctionComposition2Rule</span></a></a><span> </span><a name="local-6989586621679065689"><a href="#local-6989586621679065689"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065690"><a href="#local-6989586621679065690"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065691"><a href="#local-6989586621679065691"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065692"><a href="#local-6989586621679065692"><span class="hs-identifier">z2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065693"><a href="#local-6989586621679065693"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065694"><a href="#local-6989586621679065694"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065695"><a href="#local-6989586621679065695"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065696"><a href="#local-6989586621679065696"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065697"><a href="#local-6989586621679065697"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065698"><a href="#local-6989586621679065698"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065699"><a href="#local-6989586621679065699"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-757"></a><span>  </span><span class="hs-comment">-- [&lt;B2] y1\z1\z2  x\y2  ==&gt; x\z1\z2</span><span>
</span><a name="line-758"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065695"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065695"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065695"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span> </span><span class="hs-comment">-- Non-normal forms</span><span>
</span><a name="line-759"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065699"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-760"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-761"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065700"><a href="#local-6989586621679065700"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065689"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-762"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065697"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679065700"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065690"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-763"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065699"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-764"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065701"><a href="#local-6989586621679065701"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065702"><a href="#local-6989586621679065702"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065703"><a href="#local-6989586621679065703"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065701"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065702"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065696"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065700"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065691"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065692"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-765"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-766"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span class="hs-special">,</span><span>
</span><a name="line-767"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065689"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065694"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-768"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065703"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-769"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065703"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065698"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065693"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-770"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065689"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065694"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-771"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065689"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065694"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-772"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-773"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065689"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065694"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065699"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-775"></a><span class="hs-identifier">backwardFunctionComposition2Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065704"><a href="#local-6989586621679065704"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065704"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-776"></a><span>
</span><a name="line-777"></a><span class="hs-comment">-- | Backward function composition rule 3.</span><span>
</span><a name="line-778"></a><span class="hs-identifier">backwardFunctionComposition3Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-779"></a><a name="backwardFunctionComposition3Rule"><a href="Parser.CCG.html#backwardFunctionComposition3Rule"><span class="hs-identifier">backwardFunctionComposition3Rule</span></a></a><span> </span><a name="local-6989586621679065705"><a href="#local-6989586621679065705"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679065706"><a href="#local-6989586621679065706"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065707"><a href="#local-6989586621679065707"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065708"><a href="#local-6989586621679065708"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065709"><a href="#local-6989586621679065709"><span class="hs-identifier">z3</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065710"><a href="#local-6989586621679065710"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065711"><a href="#local-6989586621679065711"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065712"><a href="#local-6989586621679065712"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065713"><a href="#local-6989586621679065713"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065714"><a href="#local-6989586621679065714"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065715"><a href="#local-6989586621679065715"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065716"><a href="#local-6989586621679065716"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-780"></a><span>  </span><span class="hs-comment">-- [&lt;B3] y1\z1\z2\z3  x\y2  ==&gt; x\z1\z2\z3</span><span>
</span><a name="line-781"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065712"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC1"><span class="hs-identifier hs-var">BFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065712"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><a href="Parser.CCG.html#BFC2"><span class="hs-identifier hs-var">BFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065712"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span> </span><span class="hs-comment">-- Non-normal forms</span><span>
</span><a name="line-782"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065716"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-783"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-784"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065717"><a href="#local-6989586621679065717"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065705"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-785"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065714"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679065717"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065706"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-786"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065716"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-787"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065718"><a href="#local-6989586621679065718"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065719"><a href="#local-6989586621679065719"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065720"><a href="#local-6989586621679065720"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065718"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065719"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065713"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065717"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065707"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065708"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065709"><span class="hs-identifier hs-var">z3</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-788"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-789"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#BFC3"><span class="hs-identifier hs-var">BFC3</span></a><span class="hs-special">,</span><span>
</span><a name="line-790"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065705"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065711"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-791"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065720"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-792"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065720"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065715"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065710"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-793"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065705"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065711"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-794"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065705"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065711"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-795"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-796"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065705"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065711"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-797"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065716"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-798"></a><span class="hs-identifier">backwardFunctionComposition3Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065721"><a href="#local-6989586621679065721"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065721"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-799"></a><span>
</span><a name="line-800"></a><span class="hs-comment">-- | Forward function crossed composition rule.</span><span>
</span><a name="line-801"></a><span class="hs-identifier">forwardFunctionCrossedComposition1Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-802"></a><a name="forwardFunctionCrossedComposition1Rule"><a href="Parser.CCG.html#forwardFunctionCrossedComposition1Rule"><span class="hs-identifier">forwardFunctionCrossedComposition1Rule</span></a></a><span> </span><a name="local-6989586621679065722"><a href="#local-6989586621679065722"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065723"><a href="#local-6989586621679065723"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065724"><a href="#local-6989586621679065724"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065725"><a href="#local-6989586621679065725"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065726"><a href="#local-6989586621679065726"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065727"><a href="#local-6989586621679065727"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065728"><a href="#local-6989586621679065728"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679065729"><a href="#local-6989586621679065729"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065730"><a href="#local-6989586621679065730"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065731"><a href="#local-6989586621679065731"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-803"></a><span>  </span><span class="hs-comment">-- [&gt;Bx] x/y1  y2\z  ==&gt; x\z</span><span>
</span><a name="line-804"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065723"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065723"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065723"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isTNoncaseNP"><span class="hs-identifier hs-var">isTNoncaseNP</span></a><span> </span><a href="#local-6989586621679065725"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isArgumentCategory"><span class="hs-identifier hs-var">isArgumentCategory</span></a><span> </span><a href="#local-6989586621679065729"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Non-normal forms (+ Add-hoc rule 1)</span><span>
</span><a name="line-805"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065731"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-806"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-807"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065732"><a href="#local-6989586621679065732"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065727"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-808"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679065728"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065725"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679065732"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-809"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065731"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-810"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065733"><a href="#local-6989586621679065733"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065734"><a href="#local-6989586621679065734"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-811"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065735"><a href="#local-6989586621679065735"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065733"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065734"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065729"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-812"></a><span>        </span><span class="hs-comment">--if numberOfArguments z' &gt; 3  -- Ad-hoc rule 2</span><span>
</span><a name="line-813"></a><span>        </span><span class="hs-comment">--then prevlist</span><span>
</span><a name="line-814"></a><span>        </span><span class="hs-comment">--else </span><span>
</span><a name="line-815"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065736"><a href="#local-6989586621679065736"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065733"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065734"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065724"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065732"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065735"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-816"></a><span>          </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-817"></a><span>            </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#FFCx1"><span class="hs-identifier hs-var">FFCx1</span></a><span class="hs-special">,</span><span>
</span><a name="line-818"></a><span>            </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065722"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065727"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-819"></a><span>            </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065736"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-820"></a><span>            </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065736"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065726"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065730"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-821"></a><span>            </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065722"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065727"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-822"></a><span>            </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065722"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065727"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-number">100</span><span> </span><span class="hs-operator hs-var">%</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- degrade the score when this rule is used.</span><span>
</span><a name="line-823"></a><span>            </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-824"></a><span>            </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065722"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065727"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>            </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065731"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-826"></a><span class="hs-identifier">forwardFunctionCrossedComposition1Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065737"><a href="#local-6989586621679065737"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065737"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-827"></a><span>
</span><a name="line-828"></a><span class="hs-comment">-- | Forward function crossed composition rule 2.</span><span>
</span><a name="line-829"></a><span class="hs-identifier">forwardFunctionCrossedComposition2Rule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-830"></a><a name="forwardFunctionCrossedComposition2Rule"><a href="Parser.CCG.html#forwardFunctionCrossedComposition2Rule"><span class="hs-identifier">forwardFunctionCrossedComposition2Rule</span></a></a><span> </span><a name="local-6989586621679065738"><a href="#local-6989586621679065738"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065739"><a href="#local-6989586621679065739"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065740"><a href="#local-6989586621679065740"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065741"><a href="#local-6989586621679065741"><span class="hs-identifier">y1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065742"><a href="#local-6989586621679065742"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065743"><a href="#local-6989586621679065743"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065744"><a href="#local-6989586621679065744"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065745"><a href="#local-6989586621679065745"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065746"><a href="#local-6989586621679065746"><span class="hs-identifier">z2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065747"><a href="#local-6989586621679065747"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065748"><a href="#local-6989586621679065748"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-831"></a><span>  </span><span class="hs-comment">-- [&gt;Bx2] x/y1:f  y2\z1\z2:g  ==&gt; x\z1\z2</span><span>
</span><a name="line-832"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065739"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC1"><span class="hs-identifier hs-var">FFC1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065739"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC2"><span class="hs-identifier hs-var">FFC2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065739"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#FFC3"><span class="hs-identifier hs-var">FFC3</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065739"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#EC"><span class="hs-identifier hs-var">EC</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isTNoncaseNP"><span class="hs-identifier hs-var">isTNoncaseNP</span></a><span> </span><a href="#local-6989586621679065741"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isArgumentCategory"><span class="hs-identifier hs-var">isArgumentCategory</span></a><span> </span><a href="#local-6989586621679065746"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isArgumentCategory"><span class="hs-identifier hs-var">isArgumentCategory</span></a><span> </span><a href="#local-6989586621679065745"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Non-normal forms + Ad-hoc rule</span><span>
</span><a name="line-833"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065748"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-834"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-835"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065749"><a href="#local-6989586621679065749"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065743"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-836"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065741"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679065749"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065744"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-837"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065748"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-838"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065750"><a href="#local-6989586621679065750"><span class="hs-identifier">csub</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065751"><a href="#local-6989586621679065751"><span class="hs-identifier">fsub</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-839"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065752"><a href="#local-6989586621679065752"><span class="hs-identifier">z1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065750"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065751"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065745"><span class="hs-identifier hs-var">z1</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-840"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Parser.CCG.html#numberOfArguments"><span class="hs-identifier hs-var">numberOfArguments</span></a><span> </span><a href="#local-6989586621679065752"><span class="hs-identifier hs-var">z1'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">2</span><span>  </span><span class="hs-comment">-- Ad-hoc rule 2</span><span>
</span><a name="line-841"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065748"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-842"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065753"><a href="#local-6989586621679065753"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065750"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065751"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065740"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065749"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065752"><span class="hs-identifier hs-var">z1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065746"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-843"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-844"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#FFCx2"><span class="hs-identifier hs-var">FFCx2</span></a><span class="hs-special">,</span><span>
</span><a name="line-845"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065738"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065743"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-846"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065753"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-847"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065753"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065742"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065747"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-848"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065738"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065743"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-849"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065738"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065743"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-number">100</span><span> </span><span class="hs-operator hs-var">%</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- degrade the score more when this rule is used.</span><span>
</span><a name="line-850"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-851"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065738"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065743"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065748"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-853"></a><span class="hs-identifier">forwardFunctionCrossedComposition2Rule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065754"><a href="#local-6989586621679065754"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065754"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span class="hs-comment">-- | Forward functional crossed substitution rule</span><span>
</span><a name="line-856"></a><span class="hs-identifier">forwardFunctionCrossedSubstitutionRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-857"></a><a name="forwardFunctionCrossedSubstitutionRule"><a href="Parser.CCG.html#forwardFunctionCrossedSubstitutionRule"><span class="hs-identifier">forwardFunctionCrossedSubstitutionRule</span></a></a><span> </span><a name="local-6989586621679065755"><a href="#local-6989586621679065755"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679065756"><a href="#local-6989586621679065756"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065757"><a href="#local-6989586621679065757"><span class="hs-identifier">y1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065758"><a href="#local-6989586621679065758"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065759"><a href="#local-6989586621679065759"><span class="hs-identifier">f</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065760"><a href="#local-6989586621679065760"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><span class="hs-special">(</span><a name="local-6989586621679065761"><a href="#local-6989586621679065761"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679065762"><a href="#local-6989586621679065762"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065763"><a href="#local-6989586621679065763"><span class="hs-identifier">g</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065764"><a href="#local-6989586621679065764"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-858"></a><span>  </span><span class="hs-comment">-- [&gt;Sx] x/y1\z:f  y2\z:g  ==&gt; x\z: \x.(fx)(gx)</span><span>
</span><a name="line-859"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isArgumentCategory"><span class="hs-identifier hs-var">isArgumentCategory</span></a><span> </span><a href="#local-6989586621679065758"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#isArgumentCategory"><span class="hs-identifier hs-var">isArgumentCategory</span></a><span> </span><a href="#local-6989586621679065762"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- isNoncaseNP z1 -- to block CM + be-ident -- r == FFC1 || r == FFC2 || r == FFC3 || (isTNoncaseNP y1) || not (isArgumentCategory z2) || not (isArgumentCategory z1) -- Non-normal forms + Ad-hoc rule</span><span>
</span><a name="line-860"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065764"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-861"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-862"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065765"><a href="#local-6989586621679065765"><span class="hs-identifier">inc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679065760"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-863"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065758"><span class="hs-identifier hs-var">z1</span></a><span> </span><a href="#local-6989586621679065765"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065762"><span class="hs-identifier hs-var">z2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-864"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065764"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-865"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065766"><a href="#local-6989586621679065766"><span class="hs-identifier">z</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065767"><a href="#local-6989586621679065767"><span class="hs-identifier">csub1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065768"><a href="#local-6989586621679065768"><span class="hs-identifier">fsub1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-866"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065767"><span class="hs-identifier hs-var">csub1</span></a><span> </span><a href="#local-6989586621679065768"><span class="hs-identifier hs-var">fsub1</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065757"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679065765"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065761"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-867"></a><span>          </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065764"><span class="hs-identifier hs-var">prevlist</span></a><span> </span><span class="hs-comment">-- Unification failure</span><span>
</span><a name="line-868"></a><span>          </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679065769"><a href="#local-6989586621679065769"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065770"><a href="#local-6989586621679065770"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-869"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065771"><a href="#local-6989586621679065771"><span class="hs-identifier">newcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065769"><span class="hs-identifier hs-var">csub2</span></a><span> </span><a href="#local-6989586621679065770"><span class="hs-identifier hs-var">fsub2</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065756"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065765"><span class="hs-identifier hs-var">inc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065766"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-870"></a><span>                      </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-871"></a><span>                        </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#FFSx"><span class="hs-identifier hs-var">FFSx</span></a><span class="hs-special">,</span><span>
</span><a name="line-872"></a><span>                        </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065755"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065760"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-873"></a><span>                        </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065771"><span class="hs-identifier hs-var">newcat</span></a><span class="hs-special">,</span><span>
</span><a name="line-874"></a><span>                        </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065771"><span class="hs-identifier hs-var">newcat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065759"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065763"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-875"></a><span>                        </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065755"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065760"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-876"></a><span>                        </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065755"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065760"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-number">100</span><span> </span><span class="hs-operator hs-var">%</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-877"></a><span>                        </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-878"></a><span>                        </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065755"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065760"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-879"></a><span>                        </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065764"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-880"></a><span class="hs-identifier">forwardFunctionCrossedSubstitutionRule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065772"><a href="#local-6989586621679065772"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065772"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-881"></a><span>
</span><a name="line-882"></a><span class="hs-comment">-- | Coordination rule.</span><span>
</span><a name="line-883"></a><span class="hs-identifier">coordinationRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-884"></a><a name="coordinationRule"><a href="Parser.CCG.html#coordinationRule"><span class="hs-identifier">coordinationRule</span></a></a><span> </span><a name="local-6989586621679065773"><a href="#local-6989586621679065773"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">rs</span><span class="hs-glyph">=</span><a name="local-6989586621679065774"><a href="#local-6989586621679065774"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a name="local-6989586621679065775"><a href="#local-6989586621679065775"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065776"><a href="#local-6989586621679065776"><span class="hs-identifier">s1</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065777"><a href="#local-6989586621679065777"><span class="hs-identifier">cnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065778"><a href="#local-6989586621679065778"><span class="hs-identifier">conj</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065779"><a href="#local-6989586621679065779"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a name="local-6989586621679065780"><a href="#local-6989586621679065780"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sem</span><span class="hs-glyph">=</span><a name="local-6989586621679065781"><a href="#local-6989586621679065781"><span class="hs-identifier">s2</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065782"><a href="#local-6989586621679065782"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-885"></a><span>  </span><span class="hs-comment">-- [&lt;Phi&gt;] x1:f1  CONJ  x2:f2  ==&gt;  x:\lambda\vec{x} (conj f1\vec{x}) f2\vec{x}</span><span>
</span><a name="line-886"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065774"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Parser.CCG.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span>
</span><a name="line-887"></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679065782"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-888"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-889"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#endsWithT"><span class="hs-identifier hs-var">endsWithT</span></a><span> </span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Parser.CCG.html#isNStem"><span class="hs-identifier hs-var">isNStem</span></a><span> </span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679065775"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x2</span></a><span>
</span><a name="line-890"></a><span>    </span><span class="hs-comment">--if (endsWithT x2 || isNStem x2 || x2 == N) &amp;&amp; x1 == x2</span><span>
</span><a name="line-891"></a><span>       </span><span class="hs-keyword">then</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-892"></a><span>              </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span class="hs-special">,</span><span>
</span><a name="line-893"></a><span>              </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065773"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065777"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065779"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-894"></a><span>              </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span>
</span><a name="line-895"></a><span>              </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#betaReduce"><span class="hs-identifier hs-var">betaReduce</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679065778"><span class="hs-identifier hs-var">conj</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Appvec"><span class="hs-identifier hs-var">Appvec</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065776"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Appvec"><span class="hs-identifier hs-var">Appvec</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065781"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-896"></a><span>              </span><span class="hs-comment">--sem = betaReduce $ transvec x2 $ betaReduce $ Lamvec (Lam (App (App conj (App (Appvec 1 s1) (Var 0))) (App (Appvec 1 s2) (Var 0)))),</span><span>
</span><a name="line-897"></a><span>              </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065773"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065777"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065779"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-898"></a><span>              </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065773"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065779"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-899"></a><span>              </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-900"></a><span>              </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065773"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065779"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-901"></a><span>              </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065782"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-902"></a><span>       </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679065782"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-903"></a><span class="hs-identifier">coordinationRule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065783"><a href="#local-6989586621679065783"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065783"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-904"></a><span>
</span><a name="line-905"></a><span class="hs-comment">-- | Parenthesis rule.</span><span>
</span><a name="line-906"></a><span class="hs-identifier">parenthesisRule</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-907"></a><a name="parenthesisRule"><a href="Parser.CCG.html#parenthesisRule"><span class="hs-identifier">parenthesisRule</span></a></a><span> </span><a name="local-6989586621679065784"><a href="#local-6989586621679065784"><span class="hs-identifier">lnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065785"><a href="#local-6989586621679065785"><span class="hs-identifier">cnode</span></a></a><span> </span><a name="local-6989586621679065786"><a href="#local-6989586621679065786"><span class="hs-identifier">rnode</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">cat</span><span class="hs-glyph">=</span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679065787"><a href="#local-6989586621679065787"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-908"></a><span>  </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-909"></a><span>    </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#PAREN"><span class="hs-identifier hs-var">PAREN</span></a><span class="hs-special">,</span><span>
</span><a name="line-910"></a><span>    </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065784"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065785"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679065786"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-911"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cat</span><span class="hs-special">(</span><a href="#local-6989586621679065785"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-912"></a><span>    </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sem</span><span class="hs-special">(</span><a href="#local-6989586621679065785"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-913"></a><span>    </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679065784"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065785"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679065786"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-914"></a><span>    </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679065785"><span class="hs-identifier hs-var">cnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-915"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-916"></a><span>    </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065784"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679065786"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span>    </span><span class="hs-special">}</span><span class="hs-glyph">:</span><a href="#local-6989586621679065787"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-918"></a><span class="hs-identifier">parenthesisRule</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065788"><a href="#local-6989586621679065788"><span class="hs-identifier">prevlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679065788"><span class="hs-identifier hs-var">prevlist</span></a><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span class="hs-comment">{- Variable-length Lambda Calculus -}</span><span>
</span><a name="line-921"></a><span>
</span><a name="line-922"></a><span class="hs-comment">-- | Lamvec, Appvec: </span><span>
</span><a name="line-923"></a><span class="hs-comment">-- &quot;transvec&quot; function transforms the first argument (of type Preterm)</span><span>
</span><a name="line-924"></a><span class="hs-comment">-- into the one without </span><span>
</span><a name="line-925"></a><span class="hs-identifier">transvec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Preterm"><span class="hs-identifier hs-type">Preterm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Preterm"><span class="hs-identifier hs-type">Preterm</span></a><span>
</span><a name="line-926"></a><a name="transvec"><a href="Parser.CCG.html#transvec"><span class="hs-identifier">transvec</span></a></a><span> </span><a name="local-6989586621679065789"><a href="#local-6989586621679065789"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679065790"><a href="#local-6989586621679065790"><span class="hs-identifier">preterm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065789"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-927"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065791"><a href="#local-6989586621679065791"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-928"></a><span>              </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065792"><a href="#local-6989586621679065792"><span class="hs-identifier">m</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065791"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065792"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-929"></a><span>              </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065793"><a href="#local-6989586621679065793"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065791"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#addLambda"><span class="hs-identifier hs-var">addLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065793"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-930"></a><span>              </span><a name="local-6989586621679065794"><a href="#local-6989586621679065794"><span class="hs-identifier">m</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065794"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-comment">-- Var, Con, App, Proj, Asp, Appvec</span><span>
</span><a name="line-931"></a><span>                     </span><span class="hs-comment">-- Error: Type, Kind, Pi, Not, Sigma, Pair, Unit, Top, bot</span><span>
</span><a name="line-932"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065795"><a href="#local-6989586621679065795"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-933"></a><span>              </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065796"><a href="#local-6989586621679065796"><span class="hs-identifier">m</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065795"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679065796"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-934"></a><span>              </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065797"><a href="#local-6989586621679065797"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679065795"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#addLambda"><span class="hs-identifier hs-var">addLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065797"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-935"></a><span>              </span><a name="local-6989586621679065798"><a href="#local-6989586621679065798"><span class="hs-identifier">m</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065798"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-comment">-- Var, Con, App, Proj, Asp, Appvec</span><span>
</span><a name="line-936"></a><span>                     </span><span class="hs-comment">-- Error: Type, Kind, Pi, Not, Sigma, Pair, Unit, Top, bot</span><span>
</span><a name="line-937"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-938"></a><span>              </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065799"><a href="#local-6989586621679065799"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065799"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-939"></a><span>              </span><a name="local-6989586621679065800"><a href="#local-6989586621679065800"><span class="hs-identifier">m</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065800"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-940"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-941"></a><span>               </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065801"><a href="#local-6989586621679065801"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065801"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-942"></a><span>               </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065802"><a href="#local-6989586621679065802"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="#local-6989586621679065802"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-943"></a><span>               </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065803"><a href="#local-6989586621679065803"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#replaceLambda"><span class="hs-identifier hs-var">replaceLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065803"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-944"></a><span>               </span><a name="local-6989586621679065804"><a href="#local-6989586621679065804"><span class="hs-identifier">m</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065804"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-945"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-946"></a><span>               </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065805"><a href="#local-6989586621679065805"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065805"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-947"></a><span>               </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065806"><a href="#local-6989586621679065806"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="#local-6989586621679065806"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-948"></a><span>               </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065807"><a href="#local-6989586621679065807"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#replaceLambda"><span class="hs-identifier hs-var">replaceLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065807"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>               </span><a name="local-6989586621679065808"><a href="#local-6989586621679065808"><span class="hs-identifier">m</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065808"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-950"></a><span>  </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-951"></a><span>              </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065809"><a href="#local-6989586621679065809"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065809"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-952"></a><span>              </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065810"><a href="#local-6989586621679065810"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="#local-6989586621679065810"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span>              </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065811"><a href="#local-6989586621679065811"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#deleteLambda"><span class="hs-identifier hs-var">deleteLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="#local-6989586621679065811"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-954"></a><span>              </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a name="local-6989586621679065812"><a href="#local-6989586621679065812"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#replaceLambda"><span class="hs-identifier hs-var">replaceLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="#local-6989586621679065812"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-955"></a><span>              </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065813"><a href="#local-6989586621679065813"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#replaceLambda"><span class="hs-identifier hs-var">replaceLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065813"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-956"></a><span>              </span><a href="DTS.UDTT.html#Lamvec"><span class="hs-identifier hs-var">Lamvec</span></a><span> </span><a name="local-6989586621679065814"><a href="#local-6989586621679065814"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#replaceLambda"><span class="hs-identifier hs-var">replaceLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#addLambda"><span class="hs-identifier hs-var">addLambda</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679065814"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-957"></a><span>              </span><a name="local-6989586621679065815"><a href="#local-6989586621679065815"><span class="hs-identifier">m</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065815"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-958"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065790"><span class="hs-identifier hs-var">preterm</span></a><span>
</span><a name="line-959"></a><span>
</span><a name="line-960"></a><span class="hs-comment">{- Implementation of CCG Unification -}</span><span>
</span><a name="line-961"></a><span>
</span><a name="line-962"></a><span class="hs-comment">-- | returns the number of arguments of a given syntactic category.  </span><span>
</span><a name="line-963"></a><span class="hs-comment">-- For a category variable, `numberOfArguments` simply returns 0.</span><span>
</span><a name="line-964"></a><span class="hs-identifier">numberOfArguments</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-965"></a><a name="numberOfArguments"><a href="Parser.CCG.html#numberOfArguments"><span class="hs-identifier">numberOfArguments</span></a></a><span> </span><a name="local-6989586621679065816"><a href="#local-6989586621679065816"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065816"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-966"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065817"><a href="#local-6989586621679065817"><span class="hs-identifier">c1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Parser.CCG.html#numberOfArguments"><span class="hs-identifier hs-var">numberOfArguments</span></a><span> </span><a href="#local-6989586621679065817"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-967"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065818"><a href="#local-6989586621679065818"><span class="hs-identifier">c1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Parser.CCG.html#numberOfArguments"><span class="hs-identifier hs-var">numberOfArguments</span></a><span> </span><a href="#local-6989586621679065818"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-968"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-969"></a><span>
</span><a name="line-970"></a><span class="hs-comment">-- | returns a maximum index of category variables contained in a given category.</span><span>
</span><a name="line-971"></a><span class="hs-comment">--</span><span>
</span><a name="line-972"></a><span class="hs-comment">-- &gt;&gt;&gt; maximumIndex T(1)/T(3) == 3</span><span>
</span><a name="line-973"></a><span class="hs-identifier">maximumIndexC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-974"></a><a name="maximumIndexC"><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier">maximumIndexC</span></a></a><span> </span><a name="local-6989586621679065819"><a href="#local-6989586621679065819"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065819"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-975"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065820"><a href="#local-6989586621679065820"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065821"><a href="#local-6989586621679065821"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679065820"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065821"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span>
</span><a name="line-976"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065822"><a href="#local-6989586621679065822"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065823"><a href="#local-6989586621679065823"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065822"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065823"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span>
</span><a name="line-977"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065824"><a href="#local-6989586621679065824"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065825"><a href="#local-6989586621679065825"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065824"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#maximumIndexC"><span class="hs-identifier hs-var">maximumIndexC</span></a><span> </span><a href="#local-6989586621679065825"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span>
</span><a name="line-978"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><a name="local-6989586621679065826"><a href="#local-6989586621679065826"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#maximumIndexF"><span class="hs-identifier hs-var">maximumIndexF</span></a><span> </span><a href="#local-6989586621679065826"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-979"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065827"><a href="#local-6989586621679065827"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#maximumIndexF"><span class="hs-identifier hs-var">maximumIndexF</span></a><span> </span><a href="#local-6989586621679065827"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-980"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065828"><a href="#local-6989586621679065828"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#maximumIndexF"><span class="hs-identifier hs-var">maximumIndexF</span></a><span> </span><a href="#local-6989586621679065828"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-981"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-982"></a><span>
</span><a name="line-983"></a><span class="hs-identifier">maximumIndexF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-984"></a><a name="maximumIndexF"><a href="Parser.CCG.html#maximumIndexF"><span class="hs-identifier">maximumIndexF</span></a></a><span> </span><a name="local-6989586621679065829"><a href="#local-6989586621679065829"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065829"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-985"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-986"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065830"><a href="#local-6989586621679065830"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679065831"><a href="#local-6989586621679065831"><span class="hs-identifier">fs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679065830"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#maximumIndexF"><span class="hs-identifier hs-var">maximumIndexF</span></a><span> </span><a href="#local-6989586621679065831"><span class="hs-identifier hs-var">fs2</span></a><span class="hs-special">)</span><span>
</span><a name="line-987"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679065832"><a href="#local-6989586621679065832"><span class="hs-identifier">fs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#maximumIndexF"><span class="hs-identifier hs-var">maximumIndexF</span></a><span> </span><a href="#local-6989586621679065832"><span class="hs-identifier hs-var">fs2</span></a><span>
</span><a name="line-988"></a><span>
</span><a name="line-989"></a><span class="hs-comment">-- | returns </span><span>
</span><a name="line-990"></a><span class="hs-identifier">incrementIndexC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>
</span><a name="line-991"></a><a name="incrementIndexC"><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier">incrementIndexC</span></a></a><span> </span><a name="local-6989586621679065833"><a href="#local-6989586621679065833"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679065834"><a href="#local-6989586621679065834"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065833"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-992"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065835"><a href="#local-6989586621679065835"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679065836"><a href="#local-6989586621679065836"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679065837"><a href="#local-6989586621679065837"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679065835"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679065836"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065837"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-993"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065838"><a href="#local-6989586621679065838"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065839"><a href="#local-6989586621679065839"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065838"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065839"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-994"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065840"><a href="#local-6989586621679065840"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065841"><a href="#local-6989586621679065841"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065840"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexC"><span class="hs-identifier hs-var">incrementIndexC</span></a><span> </span><a href="#local-6989586621679065841"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-995"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><a name="local-6989586621679065842"><a href="#local-6989586621679065842"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexF"><span class="hs-identifier hs-var">incrementIndexF</span></a><span> </span><a href="#local-6989586621679065842"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-996"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065843"><a href="#local-6989586621679065843"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexF"><span class="hs-identifier hs-var">incrementIndexF</span></a><span> </span><a href="#local-6989586621679065843"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-997"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065844"><a href="#local-6989586621679065844"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexF"><span class="hs-identifier hs-var">incrementIndexF</span></a><span> </span><a href="#local-6989586621679065844"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065834"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-998"></a><span>  </span><a name="local-6989586621679065845"><a href="#local-6989586621679065845"><span class="hs-identifier">cc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065845"><span class="hs-identifier hs-var">cc</span></a><span>
</span><a name="line-999"></a><span>
</span><a name="line-1000"></a><span class="hs-identifier">incrementIndexF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span>
</span><a name="line-1001"></a><a name="incrementIndexF"><a href="Parser.CCG.html#incrementIndexF"><span class="hs-identifier">incrementIndexF</span></a></a><span> </span><a name="local-6989586621679065846"><a href="#local-6989586621679065846"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679065847"><a href="#local-6989586621679065847"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065846"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1002"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1003"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065848"><a href="#local-6989586621679065848"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679065849"><a href="#local-6989586621679065849"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679065850"><a href="#local-6989586621679065850"><span class="hs-identifier">fs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065847"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679065848"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065849"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexF"><span class="hs-identifier hs-var">incrementIndexF</span></a><span> </span><a href="#local-6989586621679065850"><span class="hs-identifier hs-var">fs2</span></a><span> </span><a href="#local-6989586621679065847"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-1004"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679065851"><a href="#local-6989586621679065851"><span class="hs-identifier">fh</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679065852"><a href="#local-6989586621679065852"><span class="hs-identifier">ft</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065851"><span class="hs-identifier hs-var">fh</span></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.CCG.html#incrementIndexF"><span class="hs-identifier hs-var">incrementIndexF</span></a><span> </span><a href="#local-6989586621679065852"><span class="hs-identifier hs-var">ft</span></a><span> </span><a href="#local-6989586621679065847"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-1005"></a><span>
</span><a name="line-1006"></a><span class="hs-comment">-- | Data for category/feature unification</span><span>
</span><a name="line-1007"></a><span class="hs-comment">-- csub :: SubstData Cat</span><span>
</span><a name="line-1008"></a><span class="hs-comment">-- fsub :: SubstData [FeatureValue]</span><span>
</span><a name="line-1009"></a><span class="hs-keyword">data</span><span> </span><a name="SubstData"><a href="Parser.CCG.html#SubstData"><span class="hs-identifier">SubstData</span></a></a><span> </span><a name="local-6989586621679065435"><a href="#local-6989586621679065435"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SubstLink"><a href="Parser.CCG.html#SubstLink"><span class="hs-identifier">SubstLink</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="SubstVal"><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier">SubstVal</span></a></a><span> </span><a href="#local-6989586621679065435"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-1010"></a><span class="hs-keyword">type</span><span> </span><a name="Assignment"><a href="Parser.CCG.html#Assignment"><span class="hs-identifier">Assignment</span></a></a><span> </span><a name="local-6989586621679065434"><a href="#local-6989586621679065434"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><a href="Parser.CCG.html#SubstData"><span class="hs-identifier hs-type">SubstData</span></a><span> </span><a href="#local-6989586621679065434"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1011"></a><span>
</span><a name="line-1012"></a><span class="hs-comment">-- | takes a key 'i' and a value 'v', an assignment function, and returns</span><span>
</span><a name="line-1013"></a><span class="hs-comment">-- its 'i'-variant (that maps 'i' to 'v').</span><span>
</span><a name="line-1014"></a><span class="hs-identifier">alter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679065540"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679065540"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679065540"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065541"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679065540"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679065541"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679065540"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679065541"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1015"></a><a name="alter"><a href="Parser.CCG.html#alter"><span class="hs-identifier">alter</span></a></a><span> </span><a name="local-6989586621679065853"><a href="#local-6989586621679065853"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065854"><a href="#local-6989586621679065854"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679065855"><a href="#local-6989586621679065855"><span class="hs-identifier">mp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065853"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679065854"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679065856"><a href="#local-6989586621679065856"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065853"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679065856"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065855"><span class="hs-identifier hs-var">mp</span></a><span class="hs-special">)</span><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span class="hs-comment">-- | takes an assignment, an integer 'i' (as a key) and a value 'v',</span><span>
</span><a name="line-1018"></a><span class="hs-comment">-- returns a pair of 'i' and its value if it exists,</span><span>
</span><a name="line-1019"></a><span class="hs-comment">-- or a pair of 'i' and 'v' if it does not exists or an illegal link is found in the assignment.</span><span>
</span><a name="line-1020"></a><span class="hs-identifier">fetchValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="#local-6989586621679065539"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065539"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065539"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1021"></a><a name="fetchValue"><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier">fetchValue</span></a></a><span> </span><a name="local-6989586621679065857"><a href="#local-6989586621679065857"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679065858"><a href="#local-6989586621679065858"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065859"><a href="#local-6989586621679065859"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1022"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">L.lookup</span><span> </span><a href="#local-6989586621679065858"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065857"><span class="hs-identifier hs-var">sub</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1023"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstLink"><span class="hs-identifier hs-var">SubstLink</span></a><span> </span><a name="local-6989586621679065860"><a href="#local-6989586621679065860"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679065860"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679065858"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065857"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679065860"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679065859"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1024"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a name="local-6989586621679065861"><a href="#local-6989586621679065861"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065858"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679065861"><span class="hs-identifier hs-var">v'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1025"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065858"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="#local-6989586621679065859"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span>
</span><a name="line-1027"></a><span class="hs-comment">-- | substituteCateogoryVariable </span><span>
</span><a name="line-1028"></a><span class="hs-comment">--</span><span>
</span><a name="line-1029"></a><span class="hs-comment">-- &gt;&gt;&gt; T1 [1-&gt;X/Y] ==&gt; X/Y</span><span>
</span><a name="line-1030"></a><span class="hs-identifier">simulSubstituteCV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>
</span><a name="line-1031"></a><a name="simulSubstituteCV"><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier">simulSubstituteCV</span></a></a><span> </span><a name="local-6989586621679065862"><a href="#local-6989586621679065862"><span class="hs-identifier">csub</span></a></a><span> </span><a name="local-6989586621679065863"><a href="#local-6989586621679065863"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679065864"><a href="#local-6989586621679065864"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065864"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1032"></a><span>    </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065865"><a href="#local-6989586621679065865"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065862"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065865"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065864"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1033"></a><span>    </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065866"><a href="#local-6989586621679065866"><span class="hs-identifier">ca</span></a></a><span> </span><a name="local-6989586621679065867"><a href="#local-6989586621679065867"><span class="hs-identifier">cb</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065862"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065866"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065862"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065867"><span class="hs-identifier hs-var">cb</span></a><span class="hs-special">)</span><span>
</span><a name="line-1034"></a><span>    </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065868"><a href="#local-6989586621679065868"><span class="hs-identifier">ca</span></a></a><span> </span><a name="local-6989586621679065869"><a href="#local-6989586621679065869"><span class="hs-identifier">cb</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065862"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065868"><span class="hs-identifier hs-var">ca</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteCV"><span class="hs-identifier hs-var">simulSubstituteCV</span></a><span> </span><a href="#local-6989586621679065862"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065869"><span class="hs-identifier hs-var">cb</span></a><span class="hs-special">)</span><span>
</span><a name="line-1035"></a><span>    </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><a name="local-6989586621679065870"><a href="#local-6989586621679065870"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteFV"><span class="hs-identifier hs-var">simulSubstituteFV</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065870"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-1036"></a><span>    </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065871"><a href="#local-6989586621679065871"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteFV"><span class="hs-identifier hs-var">simulSubstituteFV</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065871"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-1037"></a><span>    </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065872"><a href="#local-6989586621679065872"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#simulSubstituteFV"><span class="hs-identifier hs-var">simulSubstituteFV</span></a><span> </span><a href="#local-6989586621679065863"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065872"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-1038"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065864"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1039"></a><span>
</span><a name="line-1040"></a><span class="hs-comment">-- | unifies two syntactic categories (`Cat`) and returns a unified syntactic category, under a given category assignment and a given feature assignment.</span><span>
</span><a name="line-1041"></a><span class="hs-identifier">unifyCategory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>               </span><span class="hs-comment">-- ^ A category assignment function</span><span>
</span><a name="line-1042"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A feature assignment function</span><span>
</span><a name="line-1043"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A list of banned indices (unification to which is banned, preventing cyclic unification)</span><span>
</span><a name="line-1044"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>   </span><span class="hs-comment">-- ^ A first argument</span><span>
</span><a name="line-1045"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>   </span><span class="hs-comment">-- ^ A second argument</span><span>
</span><a name="line-1046"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1047"></a><a name="unifyCategory"><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier">unifyCategory</span></a></a><span> </span><a name="local-6989586621679065873"><a href="#local-6989586621679065873"><span class="hs-identifier">csub</span></a></a><span> </span><a name="local-6989586621679065874"><a href="#local-6989586621679065874"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679065875"><a href="#local-6989586621679065875"><span class="hs-identifier">banned</span></a></a><span> </span><a name="local-6989586621679065876"><a href="#local-6989586621679065876"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065877"><a href="#local-6989586621679065877"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1048"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065878"><a href="#local-6989586621679065878"><span class="hs-identifier">c1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065876"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1049"></a><span>              </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065879"><a href="#local-6989586621679065879"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065873"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065879"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065876"><span class="hs-identifier hs-var">c1</span></a><span>
</span><a name="line-1050"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065876"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1051"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065880"><a href="#local-6989586621679065880"><span class="hs-identifier">c2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065877"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1052"></a><span>              </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679065881"><a href="#local-6989586621679065881"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065873"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065881"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679065877"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-1053"></a><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065877"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1054"></a><span>  </span><a href="Parser.CCG.html#unifyCategory2"><span class="hs-identifier hs-var">unifyCategory2</span></a><span> </span><a href="#local-6989586621679065873"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065874"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065875"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065878"><span class="hs-identifier hs-var">c1'</span></a><span> </span><a href="#local-6989586621679065880"><span class="hs-identifier hs-var">c2'</span></a><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span class="hs-identifier">unifyCategory2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1057"></a><a name="unifyCategory2"><a href="Parser.CCG.html#unifyCategory2"><span class="hs-identifier">unifyCategory2</span></a></a><span> </span><a name="local-6989586621679065882"><a href="#local-6989586621679065882"><span class="hs-identifier">csub</span></a></a><span> </span><a name="local-6989586621679065883"><a href="#local-6989586621679065883"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679065884"><a href="#local-6989586621679065884"><span class="hs-identifier">banned</span></a></a><span> </span><a name="local-6989586621679065885"><a href="#local-6989586621679065885"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065886"><a href="#local-6989586621679065886"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065885"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><a href="#local-6989586621679065886"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1058"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065887"><a href="#local-6989586621679065887"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679065888"><a href="#local-6989586621679065888"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065889"><a href="#local-6989586621679065889"><span class="hs-identifier">u1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065890"><a href="#local-6989586621679065890"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-6989586621679065891"><a href="#local-6989586621679065891"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679065892"><a href="#local-6989586621679065892"><span class="hs-identifier">u2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1059"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065888"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679065891"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span>
</span><a name="line-1060"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1061"></a><span>    </span><span class="hs-keyword">else</span><span>
</span><a name="line-1062"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065888"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065891"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-1063"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065885"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1065"></a><span>              </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065893"><a href="#local-6989586621679065893"><span class="hs-identifier">ijmax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679065888"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065891"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679065894"><a href="#local-6989586621679065894"><span class="hs-identifier">ijmin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679065888"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065891"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-1066"></a><span>              </span><span class="hs-special">(</span><a name="local-6989586621679065895"><a href="#local-6989586621679065895"><span class="hs-identifier">u3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065896"><a href="#local-6989586621679065896"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065897"><a href="#local-6989586621679065897"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065887"><span class="hs-identifier hs-var">f1</span></a><span class="hs-special">,</span><a href="#local-6989586621679065890"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1067"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyCategory2"><span class="hs-identifier hs-var">unifyCategory2</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065889"><span class="hs-identifier hs-var">u1</span></a><span> </span><a href="#local-6989586621679065892"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-1068"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065889"><span class="hs-identifier hs-var">u1</span></a><span> </span><a href="#local-6989586621679065892"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-1069"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065892"><span class="hs-identifier hs-var">u2</span></a><span> </span><a href="#local-6989586621679065889"><span class="hs-identifier hs-var">u1</span></a><span>
</span><a name="line-1070"></a><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyCategory2"><span class="hs-identifier hs-var">unifyCategory2</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065889"><span class="hs-identifier hs-var">u1</span></a><span> </span><a href="#local-6989586621679065892"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-1071"></a><span>              </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065898"><a href="#local-6989586621679065898"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065887"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679065890"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span> </span><a href="#local-6989586621679065895"><span class="hs-identifier hs-var">u3</span></a><span>
</span><a name="line-1072"></a><span>              </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065898"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679065898"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065893"><span class="hs-identifier hs-var">ijmax</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstLink"><span class="hs-identifier hs-var">SubstLink</span></a><span> </span><a href="#local-6989586621679065894"><span class="hs-identifier hs-var">ijmin</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065896"><span class="hs-identifier hs-var">csub2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065897"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1073"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065899"><a href="#local-6989586621679065899"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679065900"><a href="#local-6989586621679065900"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065901"><a href="#local-6989586621679065901"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679065902"><a href="#local-6989586621679065902"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065900"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span>
</span><a name="line-1074"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1075"></a><span>                     </span><span class="hs-keyword">else</span><span>
</span><a name="line-1076"></a><span>                       </span><span class="hs-keyword">do</span><span>
</span><a name="line-1077"></a><span>                       </span><span class="hs-special">(</span><a name="local-6989586621679065903"><a href="#local-6989586621679065903"><span class="hs-identifier">c3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065904"><a href="#local-6989586621679065904"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065905"><a href="#local-6989586621679065905"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065899"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1078"></a><span>                                             </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065900"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065901"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679065902"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1079"></a><span>                                             </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065900"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065901"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679065902"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1080"></a><span>                       </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065903"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065900"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679065903"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065904"><span class="hs-identifier hs-var">csub2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065905"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1081"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679065906"><a href="#local-6989586621679065906"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065907"><a href="#local-6989586621679065907"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679065908"><a href="#local-6989586621679065908"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065909"><a href="#local-6989586621679065909"><span class="hs-identifier">u</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065908"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span>
</span><a name="line-1082"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1083"></a><span>                     </span><span class="hs-keyword">else</span><span>
</span><a name="line-1084"></a><span>                       </span><span class="hs-keyword">do</span><span>
</span><a name="line-1085"></a><span>                       </span><span class="hs-special">(</span><a name="local-6989586621679065910"><a href="#local-6989586621679065910"><span class="hs-identifier">c3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065911"><a href="#local-6989586621679065911"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065912"><a href="#local-6989586621679065912"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065907"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1086"></a><span>                                             </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065908"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065909"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679065906"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1087"></a><span>                                             </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065908"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065909"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679065906"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1088"></a><span>                       </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065910"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065908"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679065910"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065911"><span class="hs-identifier hs-var">csub2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065912"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1089"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065913"><a href="#local-6989586621679065913"><span class="hs-identifier">f1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a name="local-6989586621679065914"><a href="#local-6989586621679065914"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1090"></a><span>                    </span><span class="hs-special">(</span><a name="local-6989586621679065915"><a href="#local-6989586621679065915"><span class="hs-identifier">f3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065916"><a href="#local-6989586621679065916"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyFeatures"><span class="hs-identifier hs-var">unifyFeatures</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065913"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065914"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-1091"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><a href="#local-6989586621679065915"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065916"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1092"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><a name="local-6989586621679065917"><a href="#local-6989586621679065917"><span class="hs-identifier">f1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><a name="local-6989586621679065918"><a href="#local-6989586621679065918"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1093"></a><span>                  </span><span class="hs-special">(</span><a name="local-6989586621679065919"><a href="#local-6989586621679065919"><span class="hs-identifier">f3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065920"><a href="#local-6989586621679065920"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyFeatures"><span class="hs-identifier hs-var">unifyFeatures</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065917"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065918"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-1094"></a><span>                  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><a href="#local-6989586621679065919"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065920"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1095"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065921"><a href="#local-6989586621679065921"><span class="hs-identifier">f1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a name="local-6989586621679065922"><a href="#local-6989586621679065922"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1096"></a><span>                        </span><span class="hs-special">(</span><a name="local-6989586621679065923"><a href="#local-6989586621679065923"><span class="hs-identifier">f3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065924"><a href="#local-6989586621679065924"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyFeatures"><span class="hs-identifier hs-var">unifyFeatures</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065921"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679065922"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-1097"></a><span>                        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><a href="#local-6989586621679065923"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065924"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1098"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065925"><a href="#local-6989586621679065925"><span class="hs-identifier">c3</span></a></a><span> </span><a name="local-6989586621679065926"><a href="#local-6989586621679065926"><span class="hs-identifier">c4</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065927"><a href="#local-6989586621679065927"><span class="hs-identifier">c5</span></a></a><span> </span><a name="local-6989586621679065928"><a href="#local-6989586621679065928"><span class="hs-identifier">c6</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1099"></a><span>                          </span><span class="hs-special">(</span><a name="local-6989586621679065929"><a href="#local-6989586621679065929"><span class="hs-identifier">c7</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065930"><a href="#local-6989586621679065930"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065931"><a href="#local-6989586621679065931"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065926"><span class="hs-identifier hs-var">c4</span></a><span> </span><a href="#local-6989586621679065928"><span class="hs-identifier hs-var">c6</span></a><span>
</span><a name="line-1100"></a><span>                          </span><span class="hs-special">(</span><a name="local-6989586621679065932"><a href="#local-6989586621679065932"><span class="hs-identifier">c8</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065933"><a href="#local-6989586621679065933"><span class="hs-identifier">csub3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065934"><a href="#local-6989586621679065934"><span class="hs-identifier">fsub3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065930"><span class="hs-identifier hs-var">csub2</span></a><span> </span><a href="#local-6989586621679065931"><span class="hs-identifier hs-var">fsub2</span></a><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065925"><span class="hs-identifier hs-var">c3</span></a><span> </span><a href="#local-6989586621679065927"><span class="hs-identifier hs-var">c5</span></a><span>
</span><a name="line-1101"></a><span>                          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a href="#local-6989586621679065932"><span class="hs-identifier hs-var">c8</span></a><span> </span><a href="#local-6989586621679065929"><span class="hs-identifier hs-var">c7</span></a><span class="hs-special">,</span><a href="#local-6989586621679065933"><span class="hs-identifier hs-var">csub3</span></a><span class="hs-special">,</span><a href="#local-6989586621679065934"><span class="hs-identifier hs-var">fsub3</span></a><span class="hs-special">)</span><span>
</span><a name="line-1102"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065935"><a href="#local-6989586621679065935"><span class="hs-identifier">c3</span></a></a><span> </span><a name="local-6989586621679065936"><a href="#local-6989586621679065936"><span class="hs-identifier">c4</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065937"><a href="#local-6989586621679065937"><span class="hs-identifier">c5</span></a></a><span> </span><a name="local-6989586621679065938"><a href="#local-6989586621679065938"><span class="hs-identifier">c6</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1103"></a><span>                          </span><span class="hs-special">(</span><a name="local-6989586621679065939"><a href="#local-6989586621679065939"><span class="hs-identifier">c7</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065940"><a href="#local-6989586621679065940"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065941"><a href="#local-6989586621679065941"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065936"><span class="hs-identifier hs-var">c4</span></a><span> </span><a href="#local-6989586621679065938"><span class="hs-identifier hs-var">c6</span></a><span>
</span><a name="line-1104"></a><span>                          </span><span class="hs-special">(</span><a name="local-6989586621679065942"><a href="#local-6989586621679065942"><span class="hs-identifier">c8</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065943"><a href="#local-6989586621679065943"><span class="hs-identifier">csub3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065944"><a href="#local-6989586621679065944"><span class="hs-identifier">fsub3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065940"><span class="hs-identifier hs-var">csub2</span></a><span> </span><a href="#local-6989586621679065941"><span class="hs-identifier hs-var">fsub2</span></a><span> </span><a href="#local-6989586621679065884"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065935"><span class="hs-identifier hs-var">c3</span></a><span> </span><a href="#local-6989586621679065937"><span class="hs-identifier hs-var">c5</span></a><span>
</span><a name="line-1105"></a><span>                          </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a href="#local-6989586621679065942"><span class="hs-identifier hs-var">c8</span></a><span> </span><a href="#local-6989586621679065939"><span class="hs-identifier hs-var">c7</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065943"><span class="hs-identifier hs-var">csub3</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065944"><span class="hs-identifier hs-var">fsub3</span></a><span class="hs-special">)</span><span>
</span><a name="line-1106"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1107"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#CONJ"><span class="hs-identifier hs-var">CONJ</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1108"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#LPAREN"><span class="hs-identifier hs-var">LPAREN</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#RPAREN"><span class="hs-identifier hs-var">RPAREN</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065882"><span class="hs-identifier hs-var">csub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065883"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1110"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1111"></a><span>
</span><a name="line-1112"></a><span class="hs-comment">-- | unifies a cyntactic category `c1` (in `T True i c1`) with the head of `c2`, under a given feature assignment.</span><span>
</span><a name="line-1113"></a><span class="hs-identifier">unifyWithHead</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>
</span><a name="line-1114"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A feature assignment function.</span><span>
</span><a name="line-1115"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A list of indices</span><span>
</span><a name="line-1116"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>   </span><span class="hs-comment">-- ^ A first argument</span><span>
</span><a name="line-1117"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span>   </span><span class="hs-comment">-- ^ A second argument</span><span>
</span><a name="line-1118"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1119"></a><a name="unifyWithHead"><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier">unifyWithHead</span></a></a><span> </span><a name="local-6989586621679065945"><a href="#local-6989586621679065945"><span class="hs-identifier">csub</span></a></a><span> </span><a name="local-6989586621679065946"><a href="#local-6989586621679065946"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679065947"><a href="#local-6989586621679065947"><span class="hs-identifier">banned</span></a></a><span> </span><a name="local-6989586621679065948"><a href="#local-6989586621679065948"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679065949"><a href="#local-6989586621679065949"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065949"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1120"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679065950"><a href="#local-6989586621679065950"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065951"><a href="#local-6989586621679065951"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1121"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679065952"><a href="#local-6989586621679065952"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065953"><a href="#local-6989586621679065953"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065954"><a href="#local-6989586621679065954"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span> </span><a href="#local-6989586621679065945"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065946"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065947"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065948"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679065950"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1122"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a href="#local-6989586621679065952"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679065951"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065953"><span class="hs-identifier hs-var">csub2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065954"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1123"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679065955"><a href="#local-6989586621679065955"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679065956"><a href="#local-6989586621679065956"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1124"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679065957"><a href="#local-6989586621679065957"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065958"><a href="#local-6989586621679065958"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065959"><a href="#local-6989586621679065959"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyWithHead"><span class="hs-identifier hs-var">unifyWithHead</span></a><span> </span><a href="#local-6989586621679065945"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065946"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065947"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065948"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679065955"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1125"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a href="#local-6989586621679065957"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679065956"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065958"><span class="hs-identifier hs-var">csub2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065959"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1126"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679065960"><a href="#local-6989586621679065960"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679065961"><a href="#local-6989586621679065961"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065962"><a href="#local-6989586621679065962"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065961"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679065947"><span class="hs-identifier hs-var">banned</span></a><span>
</span><a name="line-1127"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1128"></a><span>                </span><span class="hs-keyword">else</span><span>
</span><a name="line-1129"></a><span>                   </span><span class="hs-keyword">do</span><span>
</span><a name="line-1130"></a><span>                   </span><span class="hs-special">(</span><a name="local-6989586621679065963"><a href="#local-6989586621679065963"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065964"><a href="#local-6989586621679065964"><span class="hs-identifier">csub2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065965"><a href="#local-6989586621679065965"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065945"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065946"><span class="hs-identifier hs-var">fsub</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065961"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679065947"><span class="hs-identifier hs-var">banned</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065948"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679065962"><span class="hs-identifier hs-var">u</span></a><span>
</span><a name="line-1131"></a><span>                   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679065960"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065961"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065963"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065961"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679065960"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679065961"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065963"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065964"><span class="hs-identifier hs-var">csub2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065965"><span class="hs-identifier hs-var">fsub2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1132"></a><span>  </span><a name="local-6989586621679065966"><a href="#local-6989586621679065966"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#unifyCategory"><span class="hs-identifier hs-var">unifyCategory</span></a><span> </span><a href="#local-6989586621679065945"><span class="hs-identifier hs-var">csub</span></a><span> </span><a href="#local-6989586621679065946"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065947"><span class="hs-identifier hs-var">banned</span></a><span> </span><a href="#local-6989586621679065948"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679065966"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1133"></a><span>
</span><a name="line-1134"></a><span class="hs-comment">-- | substituteFeatureVariable</span><span>
</span><a name="line-1135"></a><span class="hs-comment">--</span><span>
</span><a name="line-1136"></a><span class="hs-comment">-- &gt;&gt;&gt; F 1 f [1-&gt;PM] ==&gt; f[PM/1]</span><span>
</span><a name="line-1137"></a><span class="hs-identifier">substituteFV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span>
</span><a name="line-1138"></a><a name="substituteFV"><a href="Parser.CCG.html#substituteFV"><span class="hs-identifier">substituteFV</span></a></a><span> </span><a name="local-6989586621679065967"><a href="#local-6989586621679065967"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679065968"><a href="#local-6989586621679065968"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679065968"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1139"></a><span>  </span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065969"><a href="#local-6989586621679065969"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065970"><a href="#local-6989586621679065970"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065971"><a href="#local-6989586621679065971"><span class="hs-identifier">j</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065972"><a href="#local-6989586621679065972"><span class="hs-identifier">v'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065967"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065969"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065970"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a href="#local-6989586621679065971"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679065972"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1140"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679065968"><span class="hs-identifier hs-var">f1</span></a><span>
</span><a name="line-1141"></a><span>
</span><a name="line-1142"></a><span class="hs-identifier">simulSubstituteFV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span>
</span><a name="line-1143"></a><a name="simulSubstituteFV"><a href="Parser.CCG.html#simulSubstituteFV"><span class="hs-identifier">simulSubstituteFV</span></a></a><span> </span><a name="local-6989586621679065973"><a href="#local-6989586621679065973"><span class="hs-identifier">fsub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#substituteFV"><span class="hs-identifier hs-var">substituteFV</span></a><span> </span><a href="#local-6989586621679065973"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1144"></a><span>
</span><a name="line-1145"></a><span class="hs-comment">-- | unifyFeature</span><span>
</span><a name="line-1146"></a><span class="hs-identifier">unifyFeature</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1147"></a><a name="unifyFeature"><a href="Parser.CCG.html#unifyFeature"><span class="hs-identifier">unifyFeature</span></a></a><span> </span><a name="local-6989586621679065974"><a href="#local-6989586621679065974"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679065975"><a href="#local-6989586621679065975"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679065976"><a href="#local-6989586621679065976"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679065975"><span class="hs-identifier hs-var">f1</span></a><span class="hs-special">,</span><a href="#local-6989586621679065976"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1148"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065977"><a href="#local-6989586621679065977"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065978"><a href="#local-6989586621679065978"><span class="hs-identifier">v1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065979"><a href="#local-6989586621679065979"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679065980"><a href="#local-6989586621679065980"><span class="hs-identifier">v2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679065977"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679065979"><span class="hs-identifier hs-var">j</span></a><span>
</span><a name="line-1149"></a><span>                           </span><span class="hs-keyword">then</span><span>
</span><a name="line-1150"></a><span>                             </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065981"><a href="#local-6989586621679065981"><span class="hs-identifier">i'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065982"><a href="#local-6989586621679065982"><span class="hs-identifier">v1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065977"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065978"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">;</span><span>
</span><a name="line-1151"></a><span>                                 </span><a name="local-6989586621679065983"><a href="#local-6989586621679065983"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.intersect</span><span> </span><a href="#local-6989586621679065982"><span class="hs-identifier hs-var">v1'</span></a><span> </span><a href="#local-6989586621679065980"><span class="hs-identifier hs-var">v2</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1152"></a><span>                             </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679065983"><span class="hs-identifier hs-var">v3</span></a><span>
</span><a name="line-1153"></a><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1154"></a><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a href="#local-6989586621679065981"><span class="hs-identifier hs-var">i'</span></a><span> </span><a href="#local-6989586621679065983"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065981"><span class="hs-identifier hs-var">i'</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679065983"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1155"></a><span>                           </span><span class="hs-keyword">else</span><span>
</span><a name="line-1156"></a><span>                             </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065984"><a href="#local-6989586621679065984"><span class="hs-identifier">i'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065985"><a href="#local-6989586621679065985"><span class="hs-identifier">v1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065977"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065978"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">;</span><span>
</span><a name="line-1157"></a><span>                                 </span><span class="hs-special">(</span><a name="local-6989586621679065986"><a href="#local-6989586621679065986"><span class="hs-identifier">j'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065987"><a href="#local-6989586621679065987"><span class="hs-identifier">v2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065979"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679065980"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">;</span><span>
</span><a name="line-1158"></a><span>                                 </span><a name="local-6989586621679065988"><a href="#local-6989586621679065988"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.intersect</span><span> </span><a href="#local-6989586621679065985"><span class="hs-identifier hs-var">v1'</span></a><span> </span><a href="#local-6989586621679065987"><span class="hs-identifier hs-var">v2'</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1159"></a><span>                             </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679065988"><span class="hs-identifier hs-var">v3</span></a><span>
</span><a name="line-1160"></a><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1161"></a><span>                                </span><span class="hs-keyword">else</span><span>
</span><a name="line-1162"></a><span>                                  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679065989"><a href="#local-6989586621679065989"><span class="hs-identifier">ijmax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-6989586621679065984"><span class="hs-identifier hs-var">i'</span></a><span> </span><a href="#local-6989586621679065986"><span class="hs-identifier hs-var">j'</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679065990"><a href="#local-6989586621679065990"><span class="hs-identifier">ijmin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679065984"><span class="hs-identifier hs-var">i'</span></a><span> </span><a href="#local-6989586621679065986"><span class="hs-identifier hs-var">j'</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1163"></a><span>                                  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a href="#local-6989586621679065990"><span class="hs-identifier hs-var">ijmin</span></a><span> </span><a href="#local-6989586621679065988"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065989"><span class="hs-identifier hs-var">ijmax</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstLink"><span class="hs-identifier hs-var">SubstLink</span></a><span> </span><a href="#local-6989586621679065990"><span class="hs-identifier hs-var">ijmin</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065990"><span class="hs-identifier hs-var">ijmin</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679065988"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1164"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065991"><a href="#local-6989586621679065991"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679065992"><a href="#local-6989586621679065992"><span class="hs-identifier">v1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065993"><a href="#local-6989586621679065993"><span class="hs-identifier">v2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679065994"><a href="#local-6989586621679065994"><span class="hs-identifier">i'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679065995"><a href="#local-6989586621679065995"><span class="hs-identifier">v1'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065991"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679065992"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">;</span><span>
</span><a name="line-1165"></a><span>                         </span><a name="local-6989586621679065996"><a href="#local-6989586621679065996"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.intersect</span><span> </span><a href="#local-6989586621679065995"><span class="hs-identifier hs-var">v1'</span></a><span> </span><a href="#local-6989586621679065993"><span class="hs-identifier hs-var">v2</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1166"></a><span>                     </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679065996"><span class="hs-identifier hs-var">v3</span></a><span>
</span><a name="line-1167"></a><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1168"></a><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a href="#local-6989586621679065994"><span class="hs-identifier hs-var">i'</span></a><span> </span><a href="#local-6989586621679065996"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679065994"><span class="hs-identifier hs-var">i'</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679065996"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1169"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679065997"><a href="#local-6989586621679065997"><span class="hs-identifier">v1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a name="local-6989586621679065998"><a href="#local-6989586621679065998"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679065999"><a href="#local-6989586621679065999"><span class="hs-identifier">v2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066000"><a href="#local-6989586621679066000"><span class="hs-identifier">j'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066001"><a href="#local-6989586621679066001"><span class="hs-identifier">v2'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#fetchValue"><span class="hs-identifier hs-var">fetchValue</span></a><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679065998"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679065999"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">;</span><span>
</span><a name="line-1170"></a><span>                         </span><a name="local-6989586621679066002"><a href="#local-6989586621679066002"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.intersect</span><span> </span><a href="#local-6989586621679065997"><span class="hs-identifier hs-var">v1</span></a><span> </span><a href="#local-6989586621679066001"><span class="hs-identifier hs-var">v2'</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1171"></a><span>                     </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679066002"><span class="hs-identifier hs-var">v3</span></a><span>
</span><a name="line-1172"></a><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1173"></a><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SF"><span class="hs-identifier hs-var">SF</span></a><span> </span><a href="#local-6989586621679066000"><span class="hs-identifier hs-var">j'</span></a><span> </span><a href="#local-6989586621679066002"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#alter"><span class="hs-identifier hs-var">alter</span></a><span> </span><a href="#local-6989586621679066000"><span class="hs-identifier hs-var">j'</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#SubstVal"><span class="hs-identifier hs-var">SubstVal</span></a><span> </span><a href="#local-6989586621679066002"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1174"></a><span>  </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679066003"><a href="#local-6989586621679066003"><span class="hs-identifier">v1</span></a></a><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a name="local-6989586621679066004"><a href="#local-6989586621679066004"><span class="hs-identifier">v2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679066005"><a href="#local-6989586621679066005"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L.intersect</span><span> </span><a href="#local-6989586621679066003"><span class="hs-identifier hs-var">v1</span></a><span> </span><a href="#local-6989586621679066004"><span class="hs-identifier hs-var">v2</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1175"></a><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679066005"><span class="hs-identifier hs-var">v3</span></a><span>
</span><a name="line-1176"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1177"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><a href="#local-6989586621679066005"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679065974"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1178"></a><span>
</span><a name="line-1179"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-1180"></a><span class="hs-identifier">unifyFeatures</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Parser.CCG.html#Feature"><span class="hs-identifier hs-type">Feature</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Parser.CCG.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#FeatureValue"><span class="hs-identifier hs-type">FeatureValue</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1181"></a><a name="unifyFeatures"><a href="Parser.CCG.html#unifyFeatures"><span class="hs-identifier">unifyFeatures</span></a></a><span> </span><a name="local-6989586621679066006"><a href="#local-6989586621679066006"><span class="hs-identifier">fsub</span></a></a><span> </span><a name="local-6989586621679066007"><a href="#local-6989586621679066007"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679066008"><a href="#local-6989586621679066008"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066007"><span class="hs-identifier hs-var">f1</span></a><span class="hs-special">,</span><a href="#local-6989586621679066008"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1182"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679066006"><span class="hs-identifier hs-var">fsub</span></a><span class="hs-special">)</span><span>
</span><a name="line-1183"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679066009"><a href="#local-6989586621679066009"><span class="hs-identifier">f1h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679066010"><a href="#local-6989586621679066010"><span class="hs-identifier">f1t</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a name="local-6989586621679066011"><a href="#local-6989586621679066011"><span class="hs-identifier">f2h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679066012"><a href="#local-6989586621679066012"><span class="hs-identifier">f2t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1184"></a><span>                           </span><span class="hs-special">(</span><a name="local-6989586621679066013"><a href="#local-6989586621679066013"><span class="hs-identifier">f3h</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066014"><a href="#local-6989586621679066014"><span class="hs-identifier">fsub2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyFeature"><span class="hs-identifier hs-var">unifyFeature</span></a><span> </span><a href="#local-6989586621679066006"><span class="hs-identifier hs-var">fsub</span></a><span> </span><a href="#local-6989586621679066009"><span class="hs-identifier hs-var">f1h</span></a><span> </span><a href="#local-6989586621679066011"><span class="hs-identifier hs-var">f2h</span></a><span>
</span><a name="line-1185"></a><span>                           </span><span class="hs-special">(</span><a name="local-6989586621679066015"><a href="#local-6989586621679066015"><span class="hs-identifier">f3t</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066016"><a href="#local-6989586621679066016"><span class="hs-identifier">fsub3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Parser.CCG.html#unifyFeatures"><span class="hs-identifier hs-var">unifyFeatures</span></a><span> </span><a href="#local-6989586621679066014"><span class="hs-identifier hs-var">fsub2</span></a><span> </span><a href="#local-6989586621679066010"><span class="hs-identifier hs-var">f1t</span></a><span> </span><a href="#local-6989586621679066012"><span class="hs-identifier hs-var">f2t</span></a><span>
</span><a name="line-1186"></a><span>                           </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679066013"><span class="hs-identifier hs-var">f3h</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679066015"><span class="hs-identifier hs-var">f3t</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679066016"><span class="hs-identifier hs-var">fsub3</span></a><span class="hs-special">)</span><span>
</span><a name="line-1187"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1188"></a><span>
</span><a name="line-1189"></a><span class="hs-comment">{- Functions for partial parsing -}</span><span>
</span><a name="line-1190"></a><span>
</span><a name="line-1191"></a><span class="hs-identifier">category2type</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Preterm"><span class="hs-identifier hs-type">Preterm</span></a><span>
</span><a name="line-1192"></a><a name="category2type"><a href="Parser.CCG.html#category2type"><span class="hs-identifier">category2type</span></a></a><span> </span><a name="local-6989586621679066017"><a href="#local-6989586621679066017"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679066017"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1193"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679066018"><a href="#local-6989586621679066018"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679066019"><a href="#local-6989586621679066019"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066019"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066018"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1194"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679066020"><a href="#local-6989586621679066020"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679066021"><a href="#local-6989586621679066021"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066021"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066020"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1195"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;event&quot;</span><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span>
</span><a name="line-1196"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;entity&quot;</span><span>
</span><a name="line-1197"></a><span>  </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;entity&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;state&quot;</span><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1198"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;event&quot;</span><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span>
</span><a name="line-1199"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679066022"><a href="#local-6989586621679066022"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066022"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1200"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span class="hs-identifier">preterm2prop</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Preterm"><span class="hs-identifier hs-type">Preterm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Preterm"><span class="hs-identifier hs-type">Preterm</span></a><span>
</span><a name="line-1203"></a><a name="preterm2prop"><a href="Parser.CCG.html#preterm2prop"><span class="hs-identifier">preterm2prop</span></a></a><span> </span><a name="local-6989586621679066023"><a href="#local-6989586621679066023"><span class="hs-identifier">ct</span></a></a><span> </span><a name="local-6989586621679066024"><a href="#local-6989586621679066024"><span class="hs-identifier">preterm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679066023"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1204"></a><span>  </span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span> </span><a name="local-6989586621679066025"><a href="#local-6989586621679066025"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679066026"><a href="#local-6989586621679066026"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066026"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#preterm2prop"><span class="hs-identifier hs-var">preterm2prop</span></a><span> </span><a href="#local-6989586621679066025"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#shiftIndices"><span class="hs-identifier hs-var">shiftIndices</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1205"></a><span>  </span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span> </span><a name="local-6989586621679066027"><a href="#local-6989586621679066027"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679066028"><a href="#local-6989586621679066028"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#category2type"><span class="hs-identifier hs-var">category2type</span></a><span> </span><a href="#local-6989586621679066028"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#preterm2prop"><span class="hs-identifier hs-var">preterm2prop</span></a><span> </span><a href="#local-6989586621679066027"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#shiftIndices"><span class="hs-identifier hs-var">shiftIndices</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1206"></a><span>  </span><a href="Parser.CCG.html#S"><span class="hs-identifier hs-var">S</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="DTS.UDTT.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span>  </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Pi"><span class="hs-identifier hs-var">Pi</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;entity&quot;</span><span class="hs-special">)</span><span> </span><a href="DTS.UDTT.html#Type"><span class="hs-identifier hs-var">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#shiftIndices"><span class="hs-identifier hs-var">shiftIndices</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>  </span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Con"><span class="hs-identifier hs-var">Con</span></a><span> </span><span class="hs-string">&quot;entity&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#shiftIndices"><span class="hs-identifier hs-var">shiftIndices</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="DTS.UDTT.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1209"></a><span>  </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span> </span><span class="hs-special">(</span><a href="DTS.UDTT.html#Lam"><span class="hs-identifier hs-var">Lam</span></a><span> </span><a href="DTS.UDTT.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-1210"></a><span>  </span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679066029"><a href="#local-6989586621679066029"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#preterm2prop"><span class="hs-identifier hs-var">preterm2prop</span></a><span> </span><a href="#local-6989586621679066029"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#transvec"><span class="hs-identifier hs-var">transvec</span></a><span> </span><a href="#local-6989586621679066029"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">preterm</span></a><span>
</span><a name="line-1211"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DTS.UDTT.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>
</span><a name="line-1212"></a><span>
</span><a name="line-1213"></a><span class="hs-comment">-- | receives a node and returns an Sbar node, whose SR is obtained by existentially quantifying all the missing arguments of the SR of a given node.</span><span>
</span><a name="line-1214"></a><span class="hs-identifier">wrapNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span>
</span><a name="line-1215"></a><a name="wrapNode"><a href="Parser.CCG.html#wrapNode"><span class="hs-identifier">wrapNode</span></a></a><span> </span><a name="local-6989586621679066030"><a href="#local-6989586621679066030"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1216"></a><span>  </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1217"></a><span>    </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#WRAP"><span class="hs-identifier hs-var">WRAP</span></a><span class="hs-special">,</span><span>
</span><a name="line-1218"></a><span>    </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span> </span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">,</span><span>
</span><a name="line-1219"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">[</span><a href="Parser.CCG.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1220"></a><span>    </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#strongBetaReduce"><span class="hs-identifier hs-var">strongBetaReduce</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.CCG.html#preterm2prop"><span class="hs-identifier hs-var">preterm2prop</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cat</span><span> </span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1221"></a><span>          </span><span class="hs-comment">--takes a CCG node and returns a semantic reprentation of type Type, obtained by existentially quantifying empty slots.</span><span>
</span><a name="line-1222"></a><span>    </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1223"></a><span>    </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">score</span><span> </span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-number">0.9</span><span class="hs-special">,</span><span>
</span><a name="line-1224"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1225"></a><span>    </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span> </span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">node</span></a><span>
</span><a name="line-1226"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1227"></a><span>
</span><a name="line-1228"></a><span class="hs-comment">-- | receives a pair of Sbar nodes, and returns a node whose SR is their conjunction.  Note that this function does not check if given nodes are of Sbar.</span><span>
</span><a name="line-1229"></a><span class="hs-identifier">conjoinNodes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span>
</span><a name="line-1230"></a><a name="conjoinNodes"><a href="Parser.CCG.html#conjoinNodes"><span class="hs-identifier">conjoinNodes</span></a></a><span> </span><a name="local-6989586621679066031"><a href="#local-6989586621679066031"><span class="hs-identifier">lnode</span></a></a><span> </span><a name="local-6989586621679066032"><a href="#local-6989586621679066032"><span class="hs-identifier">rnode</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1231"></a><span>  </span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-1232"></a><span>    </span><span class="hs-identifier">rs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#DC"><span class="hs-identifier hs-var">DC</span></a><span class="hs-special">,</span><span>
</span><a name="line-1233"></a><span>    </span><span class="hs-identifier">pf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">pf</span><span class="hs-special">(</span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1234"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Parser.CCG.html#Sbar"><span class="hs-identifier hs-var">Sbar</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">[</span><a href="Parser.CCG.html#Decl"><span class="hs-identifier hs-var">Decl</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1235"></a><span>    </span><span class="hs-identifier">sem</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="DTS.UDTT.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sem</span><span> </span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1236"></a><span>    </span><span class="hs-identifier">daughters</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">,</span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-1237"></a><span>    </span><span class="hs-identifier">score</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">score</span><span class="hs-special">(</span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1238"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1239"></a><span>    </span><span class="hs-identifier">sig</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">lnode</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sig</span><span class="hs-special">(</span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">rnode</span></a><span class="hs-special">)</span><span>
</span><a name="line-1240"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-1241"></a><span>
</span><a name="line-1242"></a><span class="hs-comment">{-
-- | receives an Sbar node, and returns an Sbar node with DRel between a given node and some (anaphorically determined) preceding node.
drel :: Node -&gt; Node
drel node =
  Node {
    rs = DREL,
    pf = pf node,
    cat = Sbar [F[Decl]],
    sem = Sigma (sem node) (DRel 0 &quot;S&quot; (Proj Snd $ Asp 1 (Sigma Type (Var 0))) (Var 0)),
    daughters = [node],
    score = (score node)*0.9,
    source = &quot;&quot;,
    sig = sig node
    }
-}</span><span>
</span><a name="line-1257"></a><span>
</span><a name="line-1258"></a></pre></body></html>
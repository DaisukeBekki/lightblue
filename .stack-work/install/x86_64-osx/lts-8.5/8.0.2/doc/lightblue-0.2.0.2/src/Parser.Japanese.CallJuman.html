<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS -Wall #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">{-|
Module      : Parser.Japanese.CallJuman
Copyright   : (c) Daisuke Bekki, 2016
Licence     : All right reserved
Maintainer  : Daisuke Bekki &lt;bekki@is.ocha.ac.jp&gt;
Stability   : beta

A module for compound nouns in Japanese.
-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parser</span><span class="hs-operator">.</span><span class="hs-identifier">Japanese</span><span class="hs-operator">.</span><span class="hs-identifier">CallJuman</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>  </span><a href="Parser.Japanese.CallJuman.html#jumanCompoundNouns"><span class="hs-identifier hs-var">jumanCompoundNouns</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">P</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>                 </span><span class="hs-comment">--text</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>              </span><span class="hs-comment">--text</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Process</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>                 </span><span class="hs-comment">--process</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Parser.CCG.html"><span class="hs-identifier">Parser</span><span class="hs-operator">.</span><span class="hs-identifier">CCG</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Parser.Japanese.Templates.html"><span class="hs-identifier">Parser</span><span class="hs-operator">.</span><span class="hs-identifier">Japanese</span><span class="hs-operator">.</span><span class="hs-identifier">Templates</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TPL</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">{-
see :: [JumanPair] -&gt; IO([JumanPair])
see = mapM see2

see2 :: JumanPair -&gt; IO(JumanPair)
see2 noun@(j1,j2,j3,j4) = do
  T.putStr j1
  T.putStr &quot;,&quot;
  T.putStr j2
  T.putStr &quot;,&quot;
  T.putStr j3
  T.putStr &quot;,&quot;
  T.putStrLn j4
  return noun
-}</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- | Main function: jumaCompoundNouns</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- |   given a sentence, returns a list of compound nouns</span><span>
</span><a name="line-42"></a><span class="hs-identifier">jumanCompoundNouns</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><a name="jumanCompoundNouns"><a href="Parser.Japanese.CallJuman.html#jumanCompoundNouns"><span class="hs-identifier">jumanCompoundNouns</span></a></a><span> </span><a name="local-6989586621679078684"><a href="#local-6989586621679078684"><span class="hs-identifier">sentence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Parser.Japanese.CallJuman.html#jumanNouns2nodes"><span class="hs-identifier hs-var">jumanNouns2nodes</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.Japanese.CallJuman.html#callJuman"><span class="hs-identifier hs-var">callJuman</span></a><span> </span><a href="#local-6989586621679078684"><span class="hs-identifier hs-var">sentence</span></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-keyword">data</span><span> </span><a name="JumanCompNoun"><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier">JumanCompNoun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="JumanCompCN"><a href="Parser.Japanese.CallJuman.html#JumanCompCN"><span class="hs-identifier">JumanCompCN</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="JumanCompNP"><a href="Parser.Japanese.CallJuman.html#JumanCompNP"><span class="hs-identifier">JumanCompNP</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">type</span><span> </span><a name="JumanPair"><a href="Parser.Japanese.CallJuman.html#JumanPair"><span class="hs-identifier">JumanPair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (&#34920;&#23652;,&#21697;&#35422;,&#21697;&#35422;&#32048;&#20998;,&#65288;&#21205;&#35422;&#12394;&#12425;&#65289;&#27963;&#29992;&#24418;)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- | Call Juman as an external process and returns a list of juman pos-tags</span><span>
</span><a name="line-50"></a><span class="hs-identifier">callJuman</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><a name="callJuman"><a href="Parser.Japanese.CallJuman.html#callJuman"><span class="hs-identifier">callJuman</span></a></a><span> </span><a name="local-6989586621679078685"><a href="#local-6989586621679078685"><span class="hs-identifier">sentence</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679078686"><a href="#local-6989586621679078686"><span class="hs-identifier">stdout</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">S</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">runInteractiveCommand</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unpack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;echo &quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679078685"><span class="hs-identifier hs-var">sentence</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; | juman&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-comment">--(_, stdout, _, procHandle) &lt;- S.runInteractiveCommand $ T.unpack $ T.concat [&quot;echo &quot;, sentence, &quot; | juman&quot;]</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-comment">--_ &lt;- S.waitForProcess procHandle</span><span>
</span><a name="line-55"></a><span>  </span><a name="local-6989586621679078687"><a href="#local-6989586621679078687"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">hGetContents</span><span> </span><a href="#local-6989586621679078686"><span class="hs-identifier hs-var">stdout</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-comment">--terminateProcess processhandle</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-comment">--mapped &lt;- see $ map ((\l -&gt; ((l!!0),(l!!3),(l!!5),(l!!9))) . (T.split (==' '))) $ filter (\x -&gt; not (T.isPrefixOf &quot;@&quot; x)) $ P.takeWhile (/= &quot;EOS&quot;) $ T.lines t </span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-comment">--return $ findCompNouns [] mapped</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Parser.Japanese.CallJuman.html#findCompNouns"><span class="hs-identifier hs-var">findCompNouns</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679078688"><a href="#local-6989586621679078688"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679078688"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">!!</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679078688"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">!!</span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679078688"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">!!</span><span class="hs-number">5</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679078688"><span class="hs-identifier hs-var">l</span></a><span class="hs-operator hs-var">!!</span><span class="hs-number">9</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">split</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-char">' '</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679078689"><a href="#local-6989586621679078689"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isPrefixOf</span><span> </span><span class="hs-string">&quot;@&quot;</span><span> </span><a href="#local-6989586621679078689"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;EOS&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621679078687"><span class="hs-identifier hs-var">t</span></a><span> </span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- | Transforming juman pos-tags obtained from the given sentence </span><span>
</span><a name="line-62"></a><span class="hs-comment">-- | into a list of (possible) compound nouns</span><span>
</span><a name="line-63"></a><span class="hs-identifier">jumanNouns2nodes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">]</span><span>
</span><a name="line-64"></a><a name="jumanNouns2nodes"><a href="Parser.Japanese.CallJuman.html#jumanNouns2nodes"><span class="hs-identifier">jumanNouns2nodes</span></a></a><span> </span><a name="local-6989586621679078690"><a href="#local-6989586621679078690"><span class="hs-identifier">jumancompnouns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078691"><a href="#local-6989586621679078691"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679078692"><a href="#local-6989586621679078692"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;~&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679078692"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679078690"><span class="hs-identifier hs-var">jumancompnouns</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.Japanese.CallJuman.html#JumanCompNP"><span class="hs-identifier hs-var">JumanCompNP</span></a><span> </span><a name="local-6989586621679078693"><a href="#local-6989586621679078693"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679078694"><a href="#local-6989586621679078694"><span class="hs-identifier">js</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.Templates.html#lexicalitem"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lexicalitem</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679078693"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;(CompN)&quot;</span><span> </span><span class="hs-number">97</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-number">1</span><span> </span><a href="Parser.Japanese.Templates.html#modifiableS"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">modifiableS</span></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#SL"><span class="hs-identifier hs-var">SL</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-number">1</span><span> </span><a href="Parser.Japanese.Templates.html#modifiableS"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">modifiableS</span></a><span> </span><span class="hs-special">`</span><a href="Parser.CCG.html#BS"><span class="hs-identifier hs-var">BS</span></a><span class="hs-special">`</span><span> </span><a href="Parser.CCG.html#NP"><span class="hs-identifier hs-var">NP</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-special">[</span><a href="Parser.CCG.html#Nc"><span class="hs-identifier hs-var">Nc</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.Templates.html#properNameSR"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">properNameSR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078691"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679078693"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>                            </span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.Japanese.Templates.html#lexicalitem"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lexicalitem</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679078693"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;(CompN)&quot;</span><span> </span><span class="hs-number">95</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.Templates.html#commonNounSR"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">commonNounSR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078691"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679078693"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>                              </span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.Japanese.CallJuman.html#jumanNouns2nodes"><span class="hs-identifier hs-var">jumanNouns2nodes</span></a><span> </span><a href="#local-6989586621679078694"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Parser.Japanese.CallJuman.html#JumanCompCN"><span class="hs-identifier hs-var">JumanCompCN</span></a><span> </span><a name="local-6989586621679078695"><a href="#local-6989586621679078695"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679078696"><a href="#local-6989586621679078696"><span class="hs-identifier">js</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.Templates.html#lexicalitem"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lexicalitem</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679078695"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;(CompN)&quot;</span><span> </span><span class="hs-number">97</span><span> </span><span class="hs-special">(</span><a href="Parser.CCG.html#N"><span class="hs-identifier hs-var">N</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.Templates.html#commonNounSR"><span class="hs-identifier hs-var">TPL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">commonNounSR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078691"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679078695"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>                              </span><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="Parser.Japanese.CallJuman.html#jumanNouns2nodes"><span class="hs-identifier hs-var">jumanNouns2nodes</span></a><span> </span><a href="#local-6989586621679078696"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">isCNcomponent</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Parser.Japanese.CallJuman.html#JumanPair"><span class="hs-identifier hs-type">JumanPair</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-75"></a><a name="isCNcomponent"><a href="Parser.Japanese.CallJuman.html#isCNcomponent"><span class="hs-identifier">isCNcomponent</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679078697"><a href="#local-6989586621679078697"><span class="hs-identifier">j2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078698"><a href="#local-6989586621679078698"><span class="hs-identifier">j3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078699"><a href="#local-6989586621679078699"><span class="hs-identifier">j4</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679078697"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#21517;&#35422;&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-77"></a><span>     </span><a href="#local-6989586621679078697"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#21103;&#35422;&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-78"></a><span>     </span><a href="#local-6989586621679078698"><span class="hs-identifier hs-var">j3</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#21517;&#35422;&#25509;&#38957;&#36766;&quot;</span><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-79"></a><span>     </span><span class="hs-string">&quot;&#21517;&#35422;&#24615;&#21517;&#35422;&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679078698"><span class="hs-identifier hs-var">j3</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-80"></a><span>     </span><span class="hs-string">&quot;&#24418;&#23481;&#35422;&#24615;&#21517;&#35422;&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679078698"><span class="hs-identifier hs-var">j3</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-81"></a><span>     </span><span class="hs-special">(</span><a href="#local-6989586621679078697"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#29305;&#27530;&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679078698"><span class="hs-identifier hs-var">j3</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#35352;&#21495;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-82"></a><span>     </span><span class="hs-special">(</span><a href="#local-6989586621679078697"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#21205;&#35422;&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679078699"><span class="hs-identifier hs-var">j4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#22522;&#26412;&#36899;&#29992;&#24418;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-84"></a><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | usage: findCompNouns jumanPairs [] </span><span>
</span><a name="line-87"></a><span class="hs-comment">-- |   returns the list of pair (hyoso, predname)  </span><span>
</span><a name="line-88"></a><span class="hs-identifier">findCompNouns</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanPair"><span class="hs-identifier hs-type">JumanPair</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span>
</span><a name="line-89"></a><a name="findCompNouns"><a href="Parser.Japanese.CallJuman.html#findCompNouns"><span class="hs-identifier">findCompNouns</span></a></a><span> </span><a name="local-6989586621679078700"><a href="#local-6989586621679078700"><span class="hs-identifier">compNouns</span></a></a><span> </span><a name="local-6989586621679078701"><a href="#local-6989586621679078701"><span class="hs-identifier">jumanPairs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679078701"><span class="hs-identifier hs-var">jumanPairs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679078700"><span class="hs-identifier hs-var">compNouns</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679078702"><a href="#local-6989586621679078702"><span class="hs-identifier">j1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078703"><a href="#local-6989586621679078703"><span class="hs-identifier">j2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078704"><a href="#local-6989586621679078704"><span class="hs-identifier">j3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078705"><a href="#local-6989586621679078705"><span class="hs-identifier">j4</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679078706"><a href="#local-6989586621679078706"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078703"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#21517;&#35422;&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679078704"><span class="hs-identifier hs-var">j3</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#25968;&#35422;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.Japanese.CallJuman.html#processingCompNoun"><span class="hs-identifier hs-var">processingCompNoun</span></a><span> </span><a href="#local-6989586621679078700"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078706"><span class="hs-identifier hs-var">js</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078702"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679078704"><span class="hs-identifier hs-var">j3</span></a><span>
</span><a name="line-93"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078703"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#21205;&#35422;&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679078705"><span class="hs-identifier hs-var">j4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#22522;&#26412;&#36899;&#29992;&#24418;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.Japanese.CallJuman.html#processingCompNoun"><span class="hs-identifier hs-var">processingCompNoun</span></a><span> </span><a href="#local-6989586621679078700"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078706"><span class="hs-identifier hs-var">js</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078702"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679078704"><span class="hs-identifier hs-var">j3</span></a><span>
</span><a name="line-94"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078703"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#26410;&#23450;&#32681;&#35486;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.Japanese.CallJuman.html#processingCompNoun"><span class="hs-identifier hs-var">processingCompNoun</span></a><span> </span><a href="#local-6989586621679078700"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078706"><span class="hs-identifier hs-var">js</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078702"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679078704"><span class="hs-identifier hs-var">j3</span></a><span>
</span><a name="line-95"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a href="Parser.Japanese.CallJuman.html#isCNcomponent"><span class="hs-identifier hs-var">isCNcomponent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078702"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">,</span><a href="#local-6989586621679078703"><span class="hs-identifier hs-var">j2</span></a><span class="hs-special">,</span><a href="#local-6989586621679078704"><span class="hs-identifier hs-var">j3</span></a><span class="hs-special">,</span><a href="#local-6989586621679078705"><span class="hs-identifier hs-var">j4</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.Japanese.CallJuman.html#accepted1Noun"><span class="hs-identifier hs-var">accepted1Noun</span></a><span> </span><a href="#local-6989586621679078700"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078706"><span class="hs-identifier hs-var">js</span></a><span> </span><a href="#local-6989586621679078702"><span class="hs-identifier hs-var">j1</span></a><span>
</span><a name="line-96"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Parser.Japanese.CallJuman.html#findCompNouns"><span class="hs-identifier hs-var">findCompNouns</span></a><span> </span><a href="#local-6989586621679078700"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078706"><span class="hs-identifier hs-var">js</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-identifier">accepted1Noun</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanPair"><span class="hs-identifier hs-type">JumanPair</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span>
</span><a name="line-99"></a><a name="accepted1Noun"><a href="Parser.Japanese.CallJuman.html#accepted1Noun"><span class="hs-identifier">accepted1Noun</span></a></a><span> </span><a name="local-6989586621679078707"><a href="#local-6989586621679078707"><span class="hs-identifier">compNouns</span></a></a><span> </span><a name="local-6989586621679078708"><a href="#local-6989586621679078708"><span class="hs-identifier">jumanPairs</span></a></a><span> </span><a name="local-6989586621679078709"><a href="#local-6989586621679078709"><span class="hs-identifier">oneNoun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679078708"><span class="hs-identifier hs-var">jumanPairs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679078707"><span class="hs-identifier hs-var">compNouns</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679078710"><a href="#local-6989586621679078710"><span class="hs-identifier">j1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078711"><a href="#local-6989586621679078711"><span class="hs-identifier">j2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078712"><a href="#local-6989586621679078712"><span class="hs-identifier">j3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078713"><a href="#local-6989586621679078713"><span class="hs-identifier">j4</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679078714"><a href="#local-6989586621679078714"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Parser.Japanese.CallJuman.html#isCNcomponent"><span class="hs-identifier hs-var">isCNcomponent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078710"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">,</span><a href="#local-6989586621679078711"><span class="hs-identifier hs-var">j2</span></a><span class="hs-special">,</span><a href="#local-6989586621679078712"><span class="hs-identifier hs-var">j3</span></a><span class="hs-special">,</span><a href="#local-6989586621679078713"><span class="hs-identifier hs-var">j4</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679078711"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#26410;&#23450;&#32681;&#35486;&quot;</span><span>
</span><a name="line-103"></a><span>                           </span><span class="hs-keyword">then</span><span> </span><a href="Parser.Japanese.CallJuman.html#processingCompNoun"><span class="hs-identifier hs-var">processingCompNoun</span></a><span> </span><a href="#local-6989586621679078707"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078714"><span class="hs-identifier hs-var">js</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078710"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">,</span><a href="#local-6989586621679078709"><span class="hs-identifier hs-var">oneNoun</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679078712"><span class="hs-identifier hs-var">j3</span></a><span>
</span><a name="line-104"></a><span>                           </span><span class="hs-keyword">else</span><span> </span><a href="Parser.Japanese.CallJuman.html#findCompNouns"><span class="hs-identifier hs-var">findCompNouns</span></a><span> </span><a href="#local-6989586621679078707"><span class="hs-identifier hs-var">compNouns</span></a><span> </span><a href="#local-6989586621679078714"><span class="hs-identifier hs-var">js</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-identifier">processingCompNoun</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanPair"><span class="hs-identifier hs-type">JumanPair</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Parser.Japanese.CallJuman.html#JumanCompNoun"><span class="hs-identifier hs-type">JumanCompNoun</span></a><span class="hs-special">]</span><span>
</span><a name="line-107"></a><a name="processingCompNoun"><a href="Parser.Japanese.CallJuman.html#processingCompNoun"><span class="hs-identifier">processingCompNoun</span></a></a><span> </span><a name="local-6989586621679078715"><a href="#local-6989586621679078715"><span class="hs-identifier">compNouns</span></a></a><span> </span><a name="local-6989586621679078716"><a href="#local-6989586621679078716"><span class="hs-identifier">jumanPairs</span></a></a><span> </span><a name="local-6989586621679078717"><a href="#local-6989586621679078717"><span class="hs-identifier">compNoun</span></a></a><span> </span><a name="local-6989586621679078718"><a href="#local-6989586621679078718"><span class="hs-identifier">compNounHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078719"><a href="#local-6989586621679078719"><span class="hs-identifier">newCompNoun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-string">&quot;&#21517;&#35422;&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isSuffixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679078718"><span class="hs-identifier hs-var">compNounHead</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-string">&quot;&#21517;&#35422;&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679078718"><span class="hs-identifier hs-var">compNounHead</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-string">&quot;*&quot;</span><span> </span><span class="hs-operator hs-var">==</span><span>  </span><a href="#local-6989586621679078718"><span class="hs-identifier hs-var">compNounHead</span></a><span>
</span><a name="line-109"></a><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.CallJuman.html#JumanCompCN"><span class="hs-identifier hs-var">JumanCompCN</span></a><span> </span><a href="#local-6989586621679078717"><span class="hs-identifier hs-var">compNoun</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="Parser.Japanese.CallJuman.html#JumanCompNP"><span class="hs-identifier hs-var">JumanCompNP</span></a><span> </span><a href="#local-6989586621679078717"><span class="hs-identifier hs-var">compNoun</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679078716"><span class="hs-identifier hs-var">jumanPairs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679078719"><span class="hs-identifier hs-var">newCompNoun</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679078715"><span class="hs-identifier hs-var">compNouns</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679078720"><a href="#local-6989586621679078720"><span class="hs-identifier">j1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078721"><a href="#local-6989586621679078721"><span class="hs-identifier">j2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078722"><a href="#local-6989586621679078722"><span class="hs-identifier">j3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679078723"><a href="#local-6989586621679078723"><span class="hs-identifier">j4</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679078724"><a href="#local-6989586621679078724"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Parser.Japanese.CallJuman.html#isCNcomponent"><span class="hs-identifier hs-var">isCNcomponent</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078720"><span class="hs-identifier hs-var">j1</span></a><span class="hs-special">,</span><a href="#local-6989586621679078721"><span class="hs-identifier hs-var">j2</span></a><span class="hs-special">,</span><a href="#local-6989586621679078722"><span class="hs-identifier hs-var">j3</span></a><span class="hs-special">,</span><a href="#local-6989586621679078723"><span class="hs-identifier hs-var">j4</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679078721"><span class="hs-identifier hs-var">j2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;&#26410;&#23450;&#32681;&#35486;&quot;</span><span>
</span><a name="line-114"></a><span>                           </span><span class="hs-keyword">then</span><span> </span><a href="Parser.Japanese.CallJuman.html#processingCompNoun"><span class="hs-identifier hs-var">processingCompNoun</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078719"><span class="hs-identifier hs-var">newCompNoun</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679078715"><span class="hs-identifier hs-var">compNouns</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078724"><span class="hs-identifier hs-var">js</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078720"><span class="hs-identifier hs-var">j1</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679078717"><span class="hs-identifier hs-var">compNoun</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078722"><span class="hs-identifier hs-var">j3</span></a><span>
</span><a name="line-115"></a><span>                           </span><span class="hs-keyword">else</span><span> </span><a href="Parser.Japanese.CallJuman.html#findCompNouns"><span class="hs-identifier hs-var">findCompNouns</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078719"><span class="hs-identifier hs-var">newCompNoun</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679078715"><span class="hs-identifier hs-var">compNouns</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078724"><span class="hs-identifier hs-var">js</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a></pre></body></html>